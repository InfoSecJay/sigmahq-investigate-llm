title: Denied Access To Remote Desktop
id: 8e5c03fa-b7f0-11ea-b242-07e0576828d9
status: test
description: |
  This event is generated when an authenticated user who is not allowed to log on remotely attempts to connect to this computer through Remote Desktop.
  Often, this event can be generated by attackers when searching for available windows servers in the network.
references:
- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4825
author: Pushkarev Dmitry
date: 2020-06-27
modified: 2021-11-27
tags:
- attack.lateral-movement
- attack.t1021.001
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4825
  condition: selection
fields:
- EventCode
- AccountName
- ClientAddress
falsepositives:
- Valid user was not added to RDP group
level: medium
notes: |
  ### Technical Context
  The "Denied Access To Remote Desktop" detection rule identifies instances where an authenticated user attempts to access a computer via Remote Desktop Protocol (RDP) but lacks the necessary permissions. This specific scenario generates an event log with Event ID 4825 in the Windows Security logs, which is critical for security incident detection. The rule focuses on monitoring for denial of remote desktop access attempts, indicating possible reconnaissance efforts by an attacker or unauthorized access attempts by valid users. By analyzing the associated data fields such as `AccountName` and `ClientAddress`, analysts can identify the user attempting the access and the originating IP address. This rule aligns with the MITRE ATT&CK tactics of Lateral Movement, specifically with technique T1021.001â€”Remote Services, which highlights how attackers often try to leverage RDP to move within the network.
  ### Investigation Steps
  - **Verify User Permissions:** Check the user's account permissions and group memberships in Active Directory to determine whether the user should have RDP access. Look for accounts that may have been inadvertently omitted from the remote access permissions.
  - **Analyze Client Address:** Investigate the `ClientAddress` field to determine the source of the connection attempt. Cross-reference this IP with known and authorized network ranges to identify any suspicious activity.
  - **Review Security Logs:** Examine other related security logs around the time of the denied access event. Look for additional events (such as failed logins or suspicious process creation) that could indicate ongoing malicious activity.
  - **Monitor for Patterns:** Conduct a broader analysis of RDP access attempts to identify any patterns of repeated failed attempts across different user accounts or IP addresses. This may provide insight into possible reconnaissance or brute-force attempts by an attacker.
  ### Prioritization
  The alert is assigned a medium severity level due to the nature of RDP access attempts; while it might involve legitimate users who were incorrectly configured, it also poses a risk of potential lateral movement by attackers trying to exploit available RDP sessions.
  ### Blind Spots and Assumptions
  This rule may not trigger in environments where RDP access is consistently enabled for most users, leading to potential false negatives. Additionally, attackers might employ methods to spoof identities or utilize authorized user accounts for their access attempts, thus evading detection. Analysts should be aware that legitimate administrative actions (like scheduled job executions) could also generate similar logs.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
