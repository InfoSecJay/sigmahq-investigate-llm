title: New or Renamed User Account with '$' Character
id: cfeed607-6aa4-4bbd-9627-b637deb723c8
status: test
description: |
  Detects the creation of a user with the "$" character. This can be used by attackers to hide a user or trick detection systems that lack the parsing mechanisms.
references:
- https://twitter.com/SBousseaden/status/1387743867663958021
author: Ilyas Ochkov, oscd.community
date: 2019-10-25
modified: 2024-01-16
tags:
- attack.defense-evasion
- attack.t1036
logsource:
  product: windows
  service: security
detection:
  selection_create:
    EventID: 4720     # create user
    SamAccountName|contains: '$'
  selection_rename:
    EventID: 4781     # rename user
    NewTargetUserName|contains: '$'
  filter_main_homegroup:
    EventID: 4720
    TargetUserName: 'HomeGroupUser$'
  condition: 1 of selection_* and not 1 of filter_main_*
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This Sigma rule is designed to detect suspicious user account activity on Windows systems, specifically focusing on the creation or renaming of user accounts that contain a dollar sign ('$'). This character is commonly used in Windows to denote special system accounts or hidden shares, making it an attractive tactic for attackers who seek to obfuscate their actions from detection mechanisms. The rule utilizes Windows Security Event Logs, particularly monitoring Event ID 4720 for user creation and Event ID 4781 for user renaming. By highlighting changes in the user account naming structure—especially the use of '$'—the rule aims to flag potential defense evasion activities, aligning with the MITRE ATT&CK tactic of Defense Evasion (T1036).
  ### Investigation Steps
  - **Check User Account Details:** Review the details of the created or renamed user account in Active Directory or local user management tools, focusing on the account's permissions and groups to see if it follows standard naming conventions.
    
  - **Audit Recent Changes:** Use Windows Event Logs to audit recent changes made to user accounts, especially looking for unusual patterns or other accounts created or modified around the same timeframe.
  - **Correlate with Other Logs:** Investigate related logs from EDR or SIEM for unusual behavior associated with the user account, such as privilege escalations or access to sensitive resources.
  - **Review Access Attempts:** Analyze the access attempts by the newly created or renamed account using Proxy and VPN logs to see if there were any attempts to access restricted areas, indicating potential malicious activity.
  ### Prioritization
  Alerts generated by this rule are treated with medium severity in an enterprise environment, as they indicate potentially malicious behavior. The use of '$' in user accounts is atypical and could signify attempts to evade detection, necessitating prompt investigation.
  ### Blind Spots and Assumptions
  This rule may not fire in cases where the creation or renaming of accounts does not utilize the '$' character, or if an attacker employs other obfuscation techniques that do not involve '$'. Additionally, environments with custom account naming conventions may generate false negatives, leading to a lack of detection. It's also assumed that logging levels are appropriately set to capture relevant security events; a lack of logging may prevent the detection from functioning effectively.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
