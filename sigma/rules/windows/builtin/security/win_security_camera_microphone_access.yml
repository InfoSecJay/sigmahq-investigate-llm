title: Processes Accessing the Microphone and Webcam
id: 8cd538a4-62d5-4e83-810b-12d41e428d6e
status: test
description: Potential adversaries accessing the microphone and webcam in an endpoint.
references:
- https://twitter.com/duzvik/status/1269671601852813320
- https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072
author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)
date: 2020-06-07
modified: 2021-11-27
tags:
- attack.collection
- attack.t1123
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID:
    - 4657
    - 4656
    - 4663
    ObjectName|contains:
    - '\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone\NonPackaged'
    - '\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam\NonPackaged'
  condition: selection
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This Sigma detection rule identifies potential unauthorized access to the webcam and microphone on Windows endpoints by monitoring specific security events related to object access. It focuses on Event IDs 4657 (A registry value was modified), 4656 (A handle to an object was requested), and 4663 (An attempt was made to access an object), specifically targeting modifications in the Windows registry paths associated with microphone and webcam permissions. By analyzing these event logs, the rule detects instances where processes might be manipulating permissions or accessing the capabilities of these sensitive hardware devices. This behavior aligns with the MITRE ATT&CK technique T1123 (Audio Capture), which is often exploited by adversaries to gain unjustifiable surveillance capabilities on target devices.
  ### Investigation Steps
  - **Review Windows Security Logs:** Examine the logs for Event IDs 4656, 4657, and 4663 to identify any recent access attempts or modifications related to microphone and webcam permissions. Investigate the user and process associated with these events for potential unauthorized activities.
  - **Analyze Process Activity:** Utilize EDR solutions to track the processes that were active during the time of the suspicious event. Confirm if these processes are known and legitimate, or if they are unusual and might warrant further investigation.
  - **Inspect User Permissions:** Check the user account permissions that were leveraged during the access attempt. Ensure that no elevated privileges were misused or improperly granted that could have led to the exploitation of these capabilities.
  - **Validate Network Connections:** Use network detection tools to identify if the processes accessing the webcam or microphone are attempting to communicate externally. Analyze traffic patterns for any exfiltration attempts or connections to suspicious hosts.
  ### Prioritization
  Given the sensitive nature of webcam and microphone access, alerts generated by this rule warrant a medium severity level. Unauthorized access could lead to privacy violations and potential data breaches, making prompt investigation imperative in a corporate environment.
  ### Blind Spots and Assumptions
  This rule relies heavily on the correct logging of Event IDs specified, and as such, it may not fire if these logs are disabled or improperly configured. Additionally, if an adversary employs sophisticated techniques to alter or mask their activities—such as leveraging trusted processes or using legitimate software with malicious intent—this detection may fail to capture their actions. Furthermore, false positives can arise from legitimate applications that require access to these capabilities for their functionality, thus it is essential for analysts to correlate findings with contextual information.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
