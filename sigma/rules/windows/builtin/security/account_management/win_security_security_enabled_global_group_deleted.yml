title: A Security-Enabled Global Group Was Deleted
id: b237c54b-0f15-4612-a819-44b735e0de27
related:
- id: 9cf01b6c-e723-4841-a868-6d7f8245ca6e
  type: obsolete
status: stable
description: Detects activity when a security-enabled global group is deleted
references:
- https://www.cisecurity.org/controls/cis-controls-list/
- https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf
- https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf
- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730
- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634
author: Alexandr Yampolskyi, SOC Prime
date: 2023-04-26
tags:
- attack.persistence
- attack.t1098
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID:
    - 4730         # A security-enabled global group was deleted
    - 634         # Security Enabled Global Group Deleted
  condition: selection
falsepositives:
- Unknown
level: low
notes: |
  ### Technical Context
  This Sigma rule is designed to detect the deletion of a security-enabled global group within a Windows environment. Such actions can indicate potential misconfiguration, administrative oversight, or malicious activity, as unauthorized group deletions can lead to disruptions in access control and security posture. The rule looks for specific event IDs generated by the Windows Security log: Event ID 4730, which signifies a security-enabled global group being deleted and Event ID 634, which also indicates a deletion in this category. These event logs monitor changes in group structures, a critical aspect of Windows security management, aligning with the MITRE ATT&CK tactic of Persistence (TA0003) and the technique of Account Manipulation (T1098).
  ### Investigation Steps
  - **Review Security Logs:** Investigate the Windows Security Event logs for Event IDs 4730 and 634 around the time of the alert to understand the context of the group deletion.
  - **Identify User Activity:** Use EDR tools to examine which user account initiated the deletion and confirm whether that user had sufficient permissions to perform such an action.
  - **Check for Related Changes:** Look for any other related events in the security logs that occurred before or after the deletion, such as creation or modification of user accounts, which may indicate a broader issue.
  - **Assess Implications:** Evaluate the impact of the deleted group on access controls and permissions to determine if additional remediation steps, such as restoring the group or updating policies, are necessary.
  ### Prioritization
  This alert is categorized as low severity because while the deletion of a security-enabled global group can pose risks to access control, such events may also occur as part of routine administrative practices. However, all instances should be assessed to confirm whether malicious intent is involved.
  ### Blind Spots and Assumptions
  This rule may not fire if the deletion occurs without appropriate logging enabled or if event log retention policies result in the loss of relevant logs. Additionally, if a legitimate administrator performs the deletion as part of a planned maintenance task, it might not be flagged as suspicious. Engineers should consider scenarios where effective logging is not implemented, or monitoring tools fail to capture the required events.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
