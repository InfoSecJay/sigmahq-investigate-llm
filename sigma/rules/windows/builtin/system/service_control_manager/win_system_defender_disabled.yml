title: Windows Defender Threat Detection Service Disabled
id: 6c0a7755-6d31-44fa-80e1-133e57752680
related:
- id: fe34868f-6e0e-4882-81f6-c43aa8f15b62
  type: derived
status: stable
description: Detects when the "Windows Defender Threat Protection" service is disabled.
references:
- https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md
author: Ján Trenčanský, frack113
date: 2020-07-28
modified: 2024-07-02
tags:
- attack.defense-evasion
- attack.t1562.001
logsource:
  product: windows
  service: system
detection:
  selection:
    EventID: 7036
    Provider_Name: 'Service Control Manager'
        # Note: The service name and messages are localized
    param1:
    - 'Windows Defender Antivirus Service'
    - 'Service antivirus Microsoft Defender'         # French OS
    param2:
    - 'stopped'
    - 'arrêté'         # French OS
  condition: selection
falsepositives:
- Administrator actions
- Auto updates of Windows Defender causes restarts
level: medium
notes: |
  n
  ### Technical Context
  This detection rule focuses on monitoring the operational status of the "Windows Defender Threat Protection" service within a Windows environment. Specifically, it looks for Event ID 7036 generated by the Service Control Manager when the specified service is stopped. The rule checks for specific messages indicating that the Windows Defender Antivirus Service (or its localized names in non-English installations) has been disabled. By correlating these events with the MITRE ATT&CK tactic for defense evasion (T1562.001), the rule aims to identify potential attempts by adversaries to bypass security measures—indicating that an aggressive action has been taken to disable critical antivirus protections, which could signify a prelude to more damaging activities.
  Monitoring is carried out using Windows System logs, particularly focusing on Event ID 7036, which details changes to service states within the operating system. This rule helps organizations quickly detect unauthorized modifications to their security configurations, which is crucial for maintaining an effective defense posture against evolving threats.
  ### Investigation Steps
  - **Check Service Status:** Use Windows Services (services.msc) or PowerShell commands to confirm the current status of the "Windows Defender Threat Protection" service and to understand the context of the stop request.
  - **Review Event Logs:** Investigate Windows Event Logs (Application/System) around the time of the alert to gather any associated activity that may indicate how or why the service was stopped.
  - **Analyze Recent Changes:** Check for any administrative actions or updates that occurred prior to the service being stopped, especially any unexpected changes that may have implications for security configurations.
  - **Investigate User Activities:** Look into user activities via EDR logs and PowerShell history to see if any accounts with administrative privileges executed commands or made changes that led to the service being disabled.
  ### Prioritization
  The alert is categorized as medium severity due to the critical nature of antivirus services in maintaining endpoint security. Disabling such services, whether malicious or benign, can significantly expose the organization to threats and vulnerabilities.
  ### Blind Spots and Assumptions
  This rule may not capture legitimate administrative actions if, for instance, an administrator temporarily disables the service for maintenance. Additionally, it could fail to trigger if local policies or third-party tools modify service states without generating the expected Event ID 7036 log entries. Adversaries may also employ tactics to cover their tracks by enabling services back shortly after modifying them, leading to potential missed detections.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
