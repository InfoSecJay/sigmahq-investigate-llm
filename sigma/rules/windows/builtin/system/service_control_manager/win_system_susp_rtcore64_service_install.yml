title: RTCore Suspicious Service Installation
id: 91c49341-e2ef-40c0-ac45-49ec5c3fe26c
status: test
description: Detects the installation of RTCore service. Which could be an indication
  of Micro-Star MSI Afterburner vulnerable driver abuse
references:
- https://github.com/br-sn/CheekyBlinder/blob/e1764a8a0e7cda8a3716aefa35799f560686e01c/CheekyBlinder/CheekyBlinder.cpp
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-08-30
tags:
- attack.persistence
logsource:
  product: windows
  service: system
detection:
  selection:
    Provider_Name: 'Service Control Manager'
    EventID: 7045
    ServiceName: 'RTCore64'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The detection rule titled "RTCore Suspicious Service Installation" targets the installation of the RTCore64 service, which is associated with the MSI Afterburner software. This rule aims to identify potentially malicious activities where the installation of this service could indicate adversaries attempting to exploit vulnerabilities in the driver for privilege escalation or maintaining persistence on compromised systems. The rule leverages Windows Security Event Logs, specifically looking for Event ID 7045 generated by the Service Control Manager, which records new service installations. By monitoring this event, the rule can help SOC analysts determine whether an installation is legitimate or part of a malicious operation.
  In terms of the MITRE ATT&CK framework, this rule maps to the **Persistence** tactic, particularly under the technique of **Service Installer (T1050)**. Investigating alerts generated by this rule can help in identifying unauthorized service installations that indicate potential intrusions or exploitation attempts.
  ### Investigation Steps
  - **Review Event Logs:** Examine Windows Security logs for Event ID 7045 to confirm the creation of the RTCore64 service, noting the timestamp, account involved, and any other relevant metadata.
  - **Check Service Attributes:** Use PowerShell or Windows Services Manager to check the properties of the RTCore64 service, including its executable path and associated user account to determine if the service appears legitimate.
  - **Correlate with EDR Alerts:** Investigate any alerts from EDR solutions that may indicate suspicious behavior associated with the installation or execution of the RTCore64 service, such as unusual process activity.
  - **Analyze Network Connections:** Review network logs for any suspicious outbound connections related to the binary associated with the RTCore64 service, which could indicate communication with an external command and control server.
  ### Prioritization
  The severity level of high is assigned to this alert because the installation of a potentially exploitable service like RTCore64 indicates a significant security risk that could lead to further compromise of the system or the network.
  ### Blind Spots and Assumptions
  This rule may not fire if the RTCore64 service is installed using methods that do not trigger Event ID 7045 or if the event logging is misconfigured or disabled. Additionally, if the service is legitimately invoked as part of an authorized software installation or update, it may produce false positives. It is assumed that defenders have comprehensive visibility into service installations and that logging mechanisms are functioning correctly.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
