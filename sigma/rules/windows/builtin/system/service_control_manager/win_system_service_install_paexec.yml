title: PAExec Service Installation
id: de7ce410-b3fb-4e8a-b38c-3b999e2c3420
status: test
description: Detects PAExec service installation
references:
- https://www.poweradmin.com/paexec/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-10-26
tags:
- attack.execution
- attack.t1569.002
logsource:
  product: windows
  service: system
detection:
  selection_eid:
    Provider_Name: 'Service Control Manager'
    EventID: 7045
  selection_image:
  - ServiceName|startswith: 'PAExec-'
  - ImagePath|startswith: 'C:\WINDOWS\PAExec-'
  condition: all of selection_*
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  The Sigma rule "PAExec Service Installation" is designed to detect the installation of the PAExec service, a tool that allows for remote execution of commands and processes on Windows systems. It looks for specific events in the Windows Event Logs, particularly focusing on Event ID 7045, which is generated by the Service Control Manager whenever a new service is added. The rule analyzes the `Provider_Name` to ensure it pertains to the Service Control Manager, while also filtering services based on their naming conventions (i.e., those that start with "PAExec-") and their installation paths (i.e., those that begin with "C:\WINDOWS\PAExec-"). The relevant MITRE ATT&CK tactic is Execution (T1569.002), which encompasses techniques that facilitate running unauthorized processes. This detection can support incident responders in identifying potentially malicious activity related to remote execution.
  ### Investigation Steps
  - **Verify Service Installation:** Check the Windows Service Management tool or use PowerShell to confirm whether the PAExec service is installed and running on impacted systems.
  - **Correlate Event Logs:** Review Windows Event Logs, particularly focusing on Event ID 7045, to gather context around when the service was installed and any related activities.
  - **Inspect Network Activity:** Use EDR and NDR tools to analyze outgoing network connections associated with the PAExec service. Look for unusual connections that may indicate lateral movement or unauthorized access.
  - **Examine Process Activity:** Utilize Sysmon logs to analyze recent process creations that pertain to the PAExec service, including command-line arguments and parent processes to identify potential misuse.
  ### Prioritization
  When the alert for this rule is fired, it indicates a medium severity level due to the potential risks associated with unauthorized service installations that can facilitate remote command execution and elevate an adversary's capabilities within the network.
  ### Blind Spots and Assumptions
  This rule may not fire if the PAExec service is installed with different naming conventions, as the detection relies on specific prefixes. Additionally, if an adversary uses legitimate administrative credentials to install the service, it may go unnoticed by traditional security measures. The rule also assumes that the appropriate logging for Service Control Manager is enabled and properly configured in the environment to capture Event ID 7045.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
