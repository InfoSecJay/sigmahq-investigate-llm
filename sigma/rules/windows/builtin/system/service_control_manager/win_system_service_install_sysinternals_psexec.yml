title: PsExec Service Installation
id: 42c575ea-e41e-41f1-b248-8093c3e82a28
status: test
description: Detects PsExec service installation and execution events
references:
- https://www.jpcert.or.jp/english/pub/sr/ir_research.html
- https://jpcertcc.github.io/ToolAnalysisResultSheet
author: Thomas Patzke
date: 2017-06-12
modified: 2023-08-04
tags:
- attack.execution
- attack.t1569.002
- attack.s0029
logsource:
  product: windows
  service: system
detection:
  selection_eid:
    Provider_Name: 'Service Control Manager'
    EventID: 7045
  selection_service:
  - ServiceName: 'PSEXESVC'
  - ImagePath|endswith: '\PSEXESVC.exe'
  condition: all of selection_*
falsepositives:
- Unknown
level: medium
notes: |
  n
  ### Technical Context
  The "PsExec Service Installation" detection rule identifies when the PsExec service (PSEXESVC) is installed and executed on a Windows system. PsExec is a legitimate tool often used for remote execution of processes, but it can also be leveraged by attackers for malicious purposes such as lateral movement within a network. This Sigma rule focuses on monitoring Windows Event Logs generated by the Service Control Manager, particularly Event ID 7045 which logs events related to service installations. By detecting this specific service creation and its associated executable path (PSEXESVC.exe), the rule aims to unveil potentially unauthorized or suspicious usage of PsExec, correlating it with the MITRE ATT&CK technique T1569.002 (Remote Services: PsExec) which pertains to execution in the context of remote services.
  ### Investigation Steps
  - **Review Service Installation Logs:** Check for Event ID 7045 in the Windows Security Log to confirm the creation of the PSEXESVC service, noting the context of the installation and any associated user accounts.
  - **Analyze Process Creation:** Utilize EDR tools to investigate the process tree associated with the PSEXESVC service, identifying the parent process and any subsequent command-line arguments used during execution.
  - **Correlate Network Activity:** Examine network connection logs to determine if there are any outbound connections made by the PSEXESVC process that align with suspicious or unauthorized destinations, leveraging NDR tools.
  - **Inspect User Activity:** Review user activity logs (via Proxy or VPN logs) to see if the user associated with the service installation event has any prior suspicious behavior or that could indicate compromise.
  ### Prioritization
  This alert is classified as medium severity because the use of PsExec may indicate legitimate administrative actions or, more critically, the potential for malicious remote execution activities, warranting further investigation to rule out insider threats or compromised credentials.
  ### Blind spots and Assumptions
  The rule primarily relies on the correct configuration and logging of the Service Control Manager, hence if service installation logs are disabled or not sufficiently monitored, relevant events may not be captured. Additionally, the rule may not trigger when attackers use alternate methods of service installation or if they disguise their activities using different service names or executable paths. Analysts should be aware that legitimate usage of PsExec in administrative tasks could lead to false positives, necessitating contextual analysis.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
