title: Sliver C2 Default Service Installation
id: 31c51af6-e7aa-4da7-84d4-8f32cc580af2
status: test
description: Detects known malicious service installation that appear in cases in
  which a Sliver implants execute the PsExec commands
references:
- https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/client/command/commands.go#L1231
- https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2022-08-25
tags:
- attack.execution
- attack.privilege-escalation
- attack.t1543.003
- attack.t1569.002
logsource:
  product: windows
  service: system
detection:
  selection_eid:
    Provider_Name: 'Service Control Manager'
    EventID: 7045
  selection_service_1:
    ImagePath|re: '^[a-zA-Z]:\\windows\\temp\\[a-zA-Z0-9]{10}\.exe'
  selection_service_2:
    ServiceName:
    - 'Sliver'
    - 'Sliver implant'
  condition: selection_eid and 1 of selection_service_*
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The "Sliver C2 Default Service Installation" detection rule is designed to identify the installation of malicious services associated with the Sliver command-and-control (C2) framework on Windows systems. The rule monitors for specific Windows Event Log entries (Event ID 7045) generated by the Service Control Manager, which records service installations. In particular, this rule looks for services with names such as "Sliver" or "Sliver implant," alongside executable files that originate from the Windows TEMP directory, indicating that the service may have been installed by malicious actors, particularly following the execution of PsExec commands.
  This detection is underpinned by techniques such as **Execution (T1203)** and **Privilege Escalation (T1543.003)**, as outlined in the MITRE ATT&CK framework. The rule can play a critical role in identifying potential threats by focusing on suspicious service installations that could facilitate ongoing adversarial control over a compromised environment.
  ### Investigation Steps
  - **Check EDR Logs:** Search for any alerts or logs associated with process creation events related to the time the service installation was noted. Investigate the parent processes to understand how the service was initiated.
    
  - **Review Event Logs:** Inspect the System event log to collect additional context around the service installation event, particularly any preceding or following events that may indicate suspicious activity.
  - **Analyze Network Traffic:** Utilize Network Detection and Response (NDR) tools to evaluate outgoing connections from the identified service. Look for any abnormal or unauthorized communication patterns that may indicate a compromised system.
  - **Examine File System:** Search the file system for the executable in question located in the Windows TEMP directory. Assess its properties, digital signatures, and compare its hash against known malware databases.
  ### Prioritization
  This alert is classified as high severity because the installation of unauthorized services often indicates that an adversary has successfully gained persistence and control over the target system. Immediate investigation is crucial to prevent further exploitation or lateral movement within the network.
  ### Blind Spots and Assumptions
  The rule may not fire in environments where the service names or paths differ from those specified in the detection logic. Additionally, if an adversary exploits legitimate administrative tools to install the service without triggering any alerts, the rule could be bypassed. Organizations should also be aware that false positives might occur due to legitimate applications using similar naming conventions or Windows features.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environments and operational needs. Please communicate any changes to the detection engineering team.
