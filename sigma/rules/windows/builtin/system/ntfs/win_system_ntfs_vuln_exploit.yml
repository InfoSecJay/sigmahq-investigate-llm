title: NTFS Vulnerability Exploitation
id: f14719ce-d3ab-4e25-9ce6-2899092260b0
status: test
description: This the exploitation of a NTFS vulnerability as reported without many
  details via Twitter
references:
- https://twitter.com/jonasLyk/status/1347900440000811010
- https://twitter.com/wdormann/status/1347958161609809921
- https://www.bleepingcomputer.com/news/security/windows-10-bug-corrupts-your-hard-drive-on-seeing-this-files-icon/
author: Florian Roth (Nextron Systems)
date: 2021-01-11
modified: 2022-12-25
tags:
- attack.impact
- attack.t1499.001
logsource:
  product: windows
  service: system
detection:
  selection:
    Provider_Name: Ntfs
    EventID: 55
    Origin: 'File System Driver'
    Description|contains|all:
    - 'contains a corrupted file record'
    - 'The name of the file is "\"'
  condition: selection
falsepositives:
- Unlikely
level: high
notes: |
  ### Technical Context
  The detection rule titled "NTFS Vulnerability Exploitation" focuses on identifying potential exploitation attempts of a known NTFS vulnerability in Windows environments. The rule specifically looks for Event ID 55 logged by the NTFS provider, indicating issues related to corrupted file records. The presence of messages that include the phrase 'contains a corrupted file record' alongside the file name being a backslash ("\") are key indicators of a potential exploit attempting to exploit the NTFS file system's limitations. By monitoring these events, security teams can detect attacks targeting the integrity of the file system.
  The primary data source involved in this detection is the Windows system event logs, specifically those generated by the NTFS file system driver. This specific rule aims to alert SOC analysts to potential breaches or system integrity issues that may arise from exploit attempts against the NTFS file system, allowing for timely incident response actions to mitigate potential damage.
  ### Investigation Steps
  - Investigate the triggered alert in your EDR solution, examining the specific Event ID 55 to ascertain the context in which the corruption was reported.
  - Review recently created, modified, or accessed files in the file system using system logs to determine if suspicious activity correlates with the time of the event.
  - Cross-reference the affected system's logs with user activity found in the Proxy and VPN logs to identify any unauthorized access patterns or related behavior.
  - Check for any additional alerts or signs of compromise within your AV logs and network defenses, focusing on unusual network traffic patterns or alerts triggered in relation to the impacted system.
