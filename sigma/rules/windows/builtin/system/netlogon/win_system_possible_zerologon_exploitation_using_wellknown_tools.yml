title: Zerologon Exploitation Using Well-known Tools
id: 18f37338-b9bd-4117-a039-280c81f7a596
status: stable
description: This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472)
  vulnerability using mimikatz zerologon module or other exploits from machine with
  "kali" hostname.
references:
- https://www.secura.com/blog/zero-logon
- https://bi-zone.medium.com/hunting-for-zerologon-f65c61586382
author: 'Demyan Sokolin @_drd0c, Teymur Kheirkhabarov @HeirhabarovT, oscd.community'
date: 2020-10-13
modified: 2021-05-30
tags:
- attack.t1210
- attack.lateral-movement
logsource:
  service: system
  product: windows
detection:
  selection:
    EventID:
    - 5805
    - 5723
  keywords:
  - kali
  - mimikatz
  condition: selection and keywords
level: critical
notes: |
  ### Technical Context
  The Sigma rule "Zerologon Exploitation Using Well-known Tools" is designed to identify potential exploitation attempts of the Zerologon vulnerability (CVE-2020-1472). This vulnerability can allow an attacker to gain unauthorized access to Active Directory services using a specially crafted Netlogon authentication request. The rule primarily looks for specific Windows event logs, particularly Event IDs 5805 and 5723, which indicate abnormal authentication requests and modification of secure channel passwords. Additionally, it searches for the presence of keywords associated with malicious tools like Mimikatz and a system hostname indicative of a testing environment, specifically "kali." By focusing on these elements, the rule adeptly highlights suspicious activities that may indicate exploitation attempts using well-known hacking tools.
  ### Investigation Steps
  - Verify the presence of logs corresponding to Event IDs 5805 and 5723 in your EDR solution to confirm potential Zerologon exploitation attempts.
  - Cross-reference the hostname of the initiating machine with asset management to ascertain if it is indeed a legitimate system or an unauthorized device.
  - Examine proxy logs for any unusual external communications originating from the "kali" host to identify any potentially associated follow-on malicious activity.
  - Review user and system accounts involved during the time of the events to determine if any unauthorized account changes or escalations in privileges occurred.
