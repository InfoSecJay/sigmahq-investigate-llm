title: Windows Defender AMSI Trigger Detected
id: ea9bf0fa-edec-4fb8-8b78-b119f2528186
status: stable
description: Detects triggering of AMSI by Windows Defender.
references:
- https://learn.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps
author: Bhabesh Raj
date: 2020-09-14
modified: 2022-12-07
tags:
- attack.execution
- attack.t1059
logsource:
  product: windows
  service: windefend
detection:
  selection:
    EventID: 1116     # The antimalware platform detected malware or other potentially unwanted software.
    SourceName: 'AMSI'
  condition: selection
falsepositives:
- Unlikely
level: high
notes: |
  ### Technical Context
  The "Windows Defender AMSI Trigger Detected" Sigma rule identifies instances where the Anti-Malware Scan Interface (AMSI) service is invoked by Windows Defender to flag potential malware or unwanted software. Specifically, it looks for Event ID 1116, which indicates that the antimalware platform has detected suspicious activity or content. The detection relies on logs generated by the Windows Defender service, utilizing data from process creation events and antimalware triggers to surface alerts. By monitoring the interactions with the AMSI service, this rule can help spot executable files or scripts that may be attempting to evade detection mechanisms, thereby enhancing the overall security posture of the enterprise.
  ### Investigation Steps
  - Examine recent Windows Defender logs to investigate other related events that could provide context on the detected trigger and identify the file or script in question. 
  - Utilize EDR tools to analyze the process in which the AMSI trigger occurred, focusing on command-line parameters and associated parent processes to understand the chain of execution.
  - Review network traffic logs for any anomalous outbound connections made by the affected process, as this may indicate data exfiltration or further malicious activity.
  - Cross-reference user activity logs from the SIEM or Proxy to identify any unusual user behavior or access patterns that coincide with the timing of the AMSI trigger.
