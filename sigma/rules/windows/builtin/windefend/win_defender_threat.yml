title: Windows Defender Threat Detected
id: 57b649ef-ff42-4fb0-8bf6-62da243a1708
status: stable
description: Detects actions taken by Windows Defender malware detection engines
references:
- https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus
author: Ján Trenčanský
date: 2020-07-28
tags:
- attack.execution
- attack.t1059
logsource:
  product: windows
  service: windefend
detection:
  selection:
    EventID:
    - 1006         # The antimalware engine found malware or other potentially unwanted software.
    - 1015         # The antimalware platform detected suspicious behavior.
    - 1116         # The antimalware platform detected malware or other potentially unwanted software.
    - 1117         # he antimalware platform performed an action to protect your system from malware or other potentially unwanted software.
  condition: selection
falsepositives:
- Unlikely
level: high
notes: |
  ### Technical Context
  The "Windows Defender Threat Detected" detection rule monitors for specific events generated by Microsoft's built-in antivirus solution, Windows Defender. This rule targets the detection of potentially malicious activity by examining Windows Event Logs from the Windows Defender service (windefend). The rule looks for specific Event IDs, such as 1006, 1015, 1116, and 1117, which indicate the detection of malware, suspicious behavior, or actions taken by the antivirus engine to mitigate these threats. This aligns with the MITRE ATT&CK framework, particularly Tactic "Execution" and Technique "Malicious Execution" (T1059), highlighting the potential execution of malicious code or behaviors on the host system.
  By capturing these event IDs, the rule aims to alert security analysts when Windows Defender identifies malicious software. This provides critical insights into the security posture of the enterprise and allows responders to take immediate action to investigate and remediate any detected threats.
  ### Investigation Steps
  - **Review Event Logs:** Examine the Windows Event Logs for Event IDs 1006, 1015, 1116, and 1117 to understand the context of the detected threat and the exact action taken by Windows Defender.
  - **Assess Response Actions:** Identify the actions taken by Windows Defender following detection, including quarantining or removing the malware, to evaluate the immediate impact on the affected system.
  - **Utilize EDR Tools:** Leverage Endpoint Detection and Response (EDR) tools to track any additional associated behaviors or processes on the system that may have contributed to or resulted from the detection alert.
  - **Check Network Connections:** Investigate network connections initiated by the affected system around the time of the alert to identify potential command-and-control (C2) communications or further malware activity.
  ### Prioritization
  This alert is classified as high severity due to the potential risks posed by detected malware and suspicious behaviors, indicating an active threat to the enterprise environment that could lead to data breaches or system compromises if not addressed promptly.
  ### Blind Spots and Assumptions
  This rule may not fire in environments where alternative antivirus solutions are employed instead of Windows Defender or if the Event Log configuration does not capture the relevant Event IDs. Additionally, adversaries might deploy malware that avoids detection by configuring malicious code to operate in such a way that is not flagged by Windows Defender. It is also assumed that systems have not been tampered with or settings modified to suppress alert generation.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
