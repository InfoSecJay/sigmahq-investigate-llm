title: Potential NetWire RAT Activity - Registry
id: 1d218616-71b0-4c40-855b-9dbe75510f7f
status: test
description: Detects registry keys related to NetWire RAT
references:
- https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing
- https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/
- https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/
- https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line
- https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/
author: Christopher Peacock
date: 2021-10-07
modified: 2023-02-07
tags:
- attack.defense-evasion
- attack.t1112
logsource:
  product: windows
  category: registry_add
detection:
  selection:
    EventType: CreateKey
        # The configuration information is usually stored under HKCU:\Software\Netwire - RedCanary
    TargetObject|contains: '\software\NetWire'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  n
  ### Technical Context
  This detection rule is designed to identify potential activity related to the NetWire Remote Access Trojan (RAT) by monitoring for specific registry key modifications. The rule focuses on tracking the creation of registry keys that suggest the presence of NetWire, particularly in the path `HKCU:\Software\NetWire`. The key event type being monitored is `CreateKey`, which signifies the addition of new registry keys. Effective detection relies on Windows registry logs, specifically capturing events associated with registry modifications. The identified technique relates to the MITRE ATT&CK framework under **Defense Evasion (T1112)**, as adversaries often manipulate the registry to maintain persistence and evade detection.
  ### Investigation Steps
  - **Review Registry Modifications**: Check the Windows Security logs for any recent registry creations or modifications, focusing on the `HKCU:\Software\NetWire` path to clarify the context of the key creation.
  - **Analyze Process Activity**: Utilize EDR tools to correlate any processes that may have been executing concurrently with the registry key addition, especially looking for suspicious applications or scripts that are capable of installation or execution of malware.
  - **Inspect Network Activity**: Leverage network detection solutions (NDR/NGFW) to monitor for unusual outbound connections that might correspond to the timing of the registry changes, indicating potential data exfiltration or command-and-control communication.
  - **Check for Additional Indicators**: Gather and review logs from endpoint security software and any other telemetry sources (like Sysmon) for additional indicators of compromise, such as unexpected process executions or unusual command-line parameters tied to the detected registry modification.
  ### Prioritization
  Given the high severity level of this alert, it is crucial to treat any detection of NetWire RAT registry modifications as a potentially serious incident; the presence of such behavior may indicate an active compromise within the network that requires immediate investigation.
  ### Blind Spots and Assumptions
  There are several assumptions and limitations to consider: the rule relies on proper logging configurations to capture registry events; if these logs are not being captured correctly or if the threat actor employs stealth tactics (like obfuscation or legitimate administrative tools), the detection may fail. Moreover, the rule may not trigger if the attacker modifies the registry keys under different paths or uses other methods to achieve persistence, highlighting a potential gap in monitoring.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
