title: Potential NetWire RAT Activity - Registry
id: 1d218616-71b0-4c40-855b-9dbe75510f7f
status: test
description: Detects registry keys related to NetWire RAT
references:
- https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing
- https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/
- https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/
- https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line
- https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/
author: Christopher Peacock
date: 2021-10-07
modified: 2023-02-07
tags:
- attack.defense-evasion
- attack.t1112
logsource:
  product: windows
  category: registry_add
detection:
  selection:
    EventType: CreateKey
        # The configuration information is usually stored under HKCU:\Software\Netwire - RedCanary
    TargetObject|contains: '\software\NetWire'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  This Sigma rule is designed to detect potential activity related to the NetWire Remote Access Trojan (RAT) by monitoring specific changes in the Windows Registry. The rule targets registry keys that are typically created under the path `HKCU:\Software\NetWire`, indicating the installation or presence of this malware. The detection mechanism focuses on the `CreateKey` event type, which logs when a new registry key is created. By analyzing event logs from the Windows operating system, particularly registry modifications, incident responders can identify potential RAT activity and initiate further investigation into the command-and-control (C2) communications and other malicious behaviors associated with NetWire.
  ### Investigation Steps
  - Check the Windows Registry on the affected endpoint for the presence of the `HKCU:\Software\NetWire` keys to confirm the installation of the RAT.
  - Utilize an Endpoint Detection and Response (EDR) tool to review process creation logs around the time the registry keys were created, looking for any suspicious executions.
  - Analyze network traffic logs using Network Detection and Response (NDR) systems to identify any unusual outbound connections that may relate to C2 communications.
  - Investigate user activity logs to correlate any suspicious user actions or phishing attempts that may have led to the RAT's installation.
