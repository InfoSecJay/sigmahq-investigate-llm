title: Suspicious Application Allowed Through Exploit Guard
id: 42205c73-75c8-4a63-9db1-e3782e06fda0
status: test
description: Detects applications being added to the "allowed applications" list of
  exploit guard in order to bypass controlled folder settings
references:
- https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-08-05
modified: 2023-08-17
tags:
- attack.defense-evasion
- attack.t1562.001
logsource:
  category: registry_set
  product: windows
detection:
  selection_key:
    TargetObject|contains: 'SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\AllowedApplications'
  selection_paths:
    TargetObject|contains:
            # Add more paths you don't allow in your org
    - '\Users\Public\'
    - '\AppData\Local\Temp\'
    - '\Desktop\'
    - '\PerfLogs\'
    - '\Windows\Temp\'
  condition: all of selection_*
falsepositives:
- Unlikely
level: high
notes: |
  ### Technical Context
  This detection rule identifies suspicious modifications to the "allowed applications" list of Windows Defender Exploit Guard, specifically focused on Controlled Folder Access settings. Attackers may try to add malicious applications to this list, thus circumventing security measures that protect critical files and folders from unauthorized changes. The rule leverages registry set logs as the data source, monitoring for changes to the registry path where these allowed applications are recorded. By analyzing the target objects that include potential paths known for storing user-generated or temporary files, the rule aims to detect unauthorized updates that may indicate an attempt to bypass security controls.
  ### Investigation Steps
  - Examine EDR logs for any recent registry modifications to the Exploit Guard's Allowed Applications list and note any changes made around the time of the alert.
  - Utilize AV logs to determine if the newly allowed applications have been flagged previously as malicious or suspicious by your antivirus solution.
  - Review proxy logs for any unusual outbound connections or downloads associated with the applications added to the allowed list, which might indicate further compromised activity.
  - Conduct a search in cloud environment logs (e.g., AWS CloudTrail, GCP Audit Logs) for any API calls or changes that could coincide with the time of the registry modifications to assess the broader impact.
