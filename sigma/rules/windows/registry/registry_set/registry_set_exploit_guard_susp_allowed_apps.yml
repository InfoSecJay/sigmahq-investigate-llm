title: Suspicious Application Allowed Through Exploit Guard
id: 42205c73-75c8-4a63-9db1-e3782e06fda0
status: test
description: Detects applications being added to the "allowed applications" list of
  exploit guard in order to bypass controlled folder settings
references:
- https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-08-05
modified: 2023-08-17
tags:
- attack.defense-evasion
- attack.t1562.001
logsource:
  category: registry_set
  product: windows
detection:
  selection_key:
    TargetObject|contains: 'SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\AllowedApplications'
  selection_paths:
    TargetObject|contains:
            # Add more paths you don't allow in your org
    - '\Users\Public\'
    - '\AppData\Local\Temp\'
    - '\Desktop\'
    - '\PerfLogs\'
    - '\Windows\Temp\'
  condition: all of selection_*
falsepositives:
- Unlikely
level: high
notes: |
  n
  ### Technical Context
  The "Suspicious Application Allowed Through Exploit Guard" detection rule monitors changes to the Windows registry, specifically targeting the "Allowed Applications" list of Windows Defender Exploit Guard. This list is used to bypass Controlled Folder Access settings, which are designed to prevent unauthorized applications from modifying or accessing protected folders. By tracking changes to key registry paths (notably those containing `SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit Guard\Controlled Folder Access\AllowedApplications`), this rule helps identify malicious activities that aim to evade security controls and introduce potential malware to safeguarded environments. This rule corresponds to the MITRE ATT&CK tactic of **Defense Evasion** and the technique **T1562.001**.
  ### Investigation Steps
  - **Examine Registry Changes**: Utilize tools like RegEdit or command-line utilities to analyze the recent changes to registry entries under the `Controlled Folder Access` path, focusing on added applications. Identify the source and intent behind the modifications.
  - **Review EDR Alerts**: Check EDR solutions for any alerts related to the potentially malicious applications that were added to the allowed list. Look for unusual behaviors or other indicators of compromise associated with these applications.
  - **Analyze Process Creation Logs**: Query Windows Process Creation logs for executions of the added applications, paying attention to command-line arguments that could suggest misuse or exploitation attempts. Investigate whether these processes are running from unusual locations.
  - **Investigate Network Activity**: Assess network traffic logs, especially any outbound connections initiated by the newly allowed applications. Look for communication with known malicious IPs or domains to evaluate risk.
  ### Prioritization
  The alert is classified as high severity since modifications to the Exploit Guard's allowed applications can indicate an attempt to bypass critical security controls, potentially leading to serious breaches or malware infections.
  ### Blind Spots and Assumptions
  This rule may not trigger if changes are made directly without registry access logs, such as through existing applications with elevated privileges or unregistered processes. Additionally, if benign applications are manipulated, false positives can occur. Adversaries may also employ stealth tactics to modify the registry in ways that evade detection, limiting the efficacy of monitoring solely focused on registry changes.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
