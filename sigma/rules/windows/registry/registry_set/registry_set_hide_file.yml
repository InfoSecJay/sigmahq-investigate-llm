title: Displaying Hidden Files Feature Disabled
id: 5a5152f1-463f-436b-b2f5-8eceb3964b42
status: test
description: |
  Detects modifications to the "Hidden" and "ShowSuperHidden" explorer registry values in order to disable showing of hidden files and system files.
  This technique is abused by several malware families to hide their files from normal users.
references:
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry
author: frack113
date: 2022-04-02
modified: 2024-03-26
tags:
- attack.defense-evasion
- attack.t1564.001
logsource:
  category: registry_set
  product: windows
detection:
  selection:
    TargetObject|endswith:
    - '\Microsoft\Windows\CurrentVersion\Explorer\Advanced\ShowSuperHidden'
    - '\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden'
    Details: 'DWORD (0x00000000)'
  condition: selection
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This detection rule identifies alterations made to important Windows registry values, specifically "Hidden" and "ShowSuperHidden," which control the visibility of hidden files and system files in Windows Explorer. Malware often targets these registry settings to conceal malicious files from users and security tools, enabling stealthy operations. The rule monitors changes to these particular registry keys, looking for a setting of 'DWORD (0x00000000)' which indicates that hidden files are disabled. The log source for this detection is registry events, providing alerts when modifications to the specified keys occur. This activity is aligned with the MITRE ATT&CK tactic of **Defense Evasion** and technique **T1564.001**, which is aimed at obscuring malicious activities.
  ### Investigation Steps
  - **Check Registry Changes:** Use Windows Event Logs to review the registry changes associated with the keys `ShowSuperHidden` and `Hidden` to determine the timestamp and user context that made the changes.
  - **Correlate with EDR Data:** Investigate any related endpoint activity through your EDR solution to uncover if any other suspicious actions were performed around the time the registry change occurred.
  - **Review Running Processes:** Examine currently running processes on the affected system for any unrecognized or suspicious executables that could correlate with the modification of the registry settings.
  - **Check User Activity Logs:** Analyze user activity logs to identify who made the changes and if their account shows any prior indicators of compromise or anomalous behavior.
  ### Prioritization
  Alerts generated by this rule are considered of medium severity due to their potential indication of malware attempting to evade detection. Prompt investigation is necessary, as such alterations may lead to the concealment of malicious activity or files on the system.
  ### Blind Spots and Assumptions
  This rule may not fire if the registry changes were made without appropriate logging enabled or if the changes were reverted quickly after being set (e.g., by other security measures on the endpoint). Furthermore, sophisticated adversaries might employ alternate methods to hide their activities that do not involve direct registry modifications. It is also assumed that the environment has not implemented policies that prevent users from making such changes, which could create false negatives.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and applicability, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
