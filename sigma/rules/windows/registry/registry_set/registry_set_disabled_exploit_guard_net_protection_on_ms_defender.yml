title: Disable Exploit Guard Network Protection on Windows Defender
id: bf9e1387-b040-4393-9851-1598f8ecfae9
status: test
description: Detects disabling Windows Defender Exploit Guard Network Protection
references:
- https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html
author: Austin Songer @austinsonger
date: 2021-08-04
modified: 2023-08-17
tags:
- attack.defense-evasion
- attack.t1562.001
logsource:
  category: registry_set
  product: windows
detection:
  selection:
    TargetObject|contains: 'SOFTWARE\Policies\Microsoft\Windows Defender Security
      Center\App and Browser protection\DisallowExploitProtectionOverride'
    Details: 'DWORD (00000001)'
  condition: selection
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This detection rule is designed to identify attempts to disable the Windows Defender Exploit Guard Network Protection by monitoring specific changes to the Windows Registry. The rule looks for entries in the registry that indicate that the policy to allow overrides for Exploit Protection settings has been altered, specifically targeting the registry path `SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection\DisallowExploitProtectionOverride`. A value of `DWORD (00000001)` at this location signifies that Exploit Guard protection has been disabled, which is a significant maneuver often associated with cyber adversaries attempting to evade detection and establish a foothold in a system. This activity corresponds to the MITRE ATT&CK tactic of **Defense Evasion** (T1562.001), where attackers tip the balance of security in their favor by disabling protective measures.
  To ensure that this rule operates effectively, it relies on Windows Security event logs, particularly monitoring registry changes that pertain to security policy modifications. The potential for attackers to tamper with these settings makes it crucial for incident responders to act quickly when alerted, as these modifications could signify a larger compromise within the organization's defenses.
  ### Investigation Steps
  - **Examine Registry Changes**: Utilize a registry monitoring tool to check for recent modifications related to the registry path referenced in the alert. Look for entries that correspond to the disallowed Exploit Protection overrides.
  - **Correlate with EDR Alerts**: Check EDR data for any suspicious process activity or behavior around the time of the registry change. Look for processes that may have initiated unauthorized changes to the system.
  - **Review Event Logs**: Analyze Windows Security and System event logs for any processes that performed changes or access to the registry. Pay special attention to events around Process Creation and Registry Write events.
  - **Assess Other Security Controls**: Investigate any logs from your Endpoint Detection and Response (EDR) systems, Firewalls, or other security controls to identify if any assisted in bypassing the Exploit Protection mechanism or if there were other brushed protections.
  ### Prioritization
  This alert is prioritized at a medium severity level due to its clear indication of a potential defensive security control being bypassed, which could signal preparatory actions for a more extensive compromise. Immediate analysis is required to ensure this does not lead to larger security incidents.
  ### Blind Spots and Assumptions
  This rule may not fire if the registry changes are carried out using non-standard methods, such as using custom scripts or directly manipulating the registry with tools that do not generate standard Windows events. Additionally, if the organization employs Group Policy Objects (GPO) or other methods to manage a large number of endpoints, the patching or continuous resetting of these values may mask attempted overrides. Therefore, itâ€™s essential to assume there may be scenarios where legitimate administrative actions could generate similar logs, leading to false positives.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
