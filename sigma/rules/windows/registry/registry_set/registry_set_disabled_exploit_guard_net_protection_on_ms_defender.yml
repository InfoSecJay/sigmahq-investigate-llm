title: Disable Exploit Guard Network Protection on Windows Defender
id: bf9e1387-b040-4393-9851-1598f8ecfae9
status: test
description: Detects disabling Windows Defender Exploit Guard Network Protection
references:
- https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html
author: Austin Songer @austinsonger
date: 2021-08-04
modified: 2023-08-17
tags:
- attack.defense-evasion
- attack.t1562.001
logsource:
  category: registry_set
  product: windows
detection:
  selection:
    TargetObject|contains: 'SOFTWARE\Policies\Microsoft\Windows Defender Security
      Center\App and Browser protection\DisallowExploitProtectionOverride'
    Details: 'DWORD (00000001)'
  condition: selection
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This detection rule monitors changes to the Windows Registry that signal the disabling of Exploit Guard Network Protection within Windows Defender. Specifically, it looks for registry modifications where the target object path includes "SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection\DisallowExploitProtectionOverride", and the value is set to '00000001'. When this value is altered, it indicates that network protection mechanisms, designed to prevent various forms of exploitation, have been disabled. Such changes could be indicative of an attacker trying to bypass security safeguards, making this a critical area for monitoring in enterprise environments where system integrity and protection against vulnerabilities are paramount.
  ### Investigation Steps
  - Use the EDR tool to review process creation logs around the time of the registry modification to identify any suspicious activities or processes that may have initiated the change. Look for unusual execution patterns or known malicious binaries.
  - Query the Windows Event Logs for events related to registry changes to correlate the timestamp with other security events, providing additional context to the incident.
  - Check for any associated alerts in the AV solution that may show signs of malicious activity coinciding with the registry modifications, as they may offer insights into the techniques used for exploitation.
  - Review proxy and network logs for any anomalous outbound connections following the registry change; this might uncover potential data exfiltration or command-and-control communication by compromised systems.
