title: Driver Load From A Temporary Directory
id: 2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75
status: test
description: Detects a driver load from a temporary directory
references:
- Internal Research
author: Florian Roth (Nextron Systems)
date: 2017-02-12
modified: 2021-11-27
tags:
- attack.persistence
- attack.privilege-escalation
- attack.t1543.003
logsource:
  category: driver_load
  product: windows
detection:
  selection:
    ImageLoaded|contains: '\Temp\'
  condition: selection
falsepositives:
- There is a relevant set of false positives depending on applications in the environment
level: high
notes: |
  ### Technical Context
  The Sigma rule titled "Driver Load From A Temporary Directory" is designed to detect instances where a Windows driver is loaded from a temporary directory, specifically denoted by the path containing `\Temp\`. This behavior is often associated with malicious activities, such as privilege escalation or the use of unauthorized drivers, as attackers may use temporary directories to avoid detection by conventional security measures. The rule leverages data from Windows event logs focused on driver load events, enabling detection of potential misuse and anomalies that are indicative of malicious intent. This aligns with the MITRE ATT&CK framework, particularly the tactic of Persistence and the technique T1543.003, which addresses the creation of system services.
  ### Investigation Steps
  - **Check Driver Load Events**: Utilize the Windows Event Logs to review driver load events and confirm if the driver was indeed loaded from a temporary directory. Look for event IDs that pertain to driver management and loading.
  - **Validate Driver Integrity**: Investigate the loaded driverâ€™s publisher and digital signature using an EDR solution. Compare the driver against known safe sources or databases to ascertain if it is legitimate or potentially harmful.
  - **Inspect Process Behavior**: Analyze any related process executions at the time of the driver load by examining Sysmon logs for abnormal process activity or unauthorized changes. This can help identify if a malicious process is responsible for loading the suspicious driver.
  - **Review Network Activity**: Utilize network detection tools to monitor for any unusual outbound or inbound traffic that correlates with the timestamps of the driver load detections. This could provide additional context regarding command and control activity or data exfiltration attempts.
  ### Prioritization
  The alert generated by this rule is considered high severity as loading drivers from non-standard locations like temporary directories could indicate an advanced threat actor attempting to escalate privileges or maintain persistence on the system. It's a critical deviation from normal operating procedures that warrants immediate investigation.
  ### Blind Spots and Assumptions
  This rule may not fire in environments where applications intentionally load drivers from temporary locations as part of their normal function, which could lead to false positives. Additional limitations include potential evasion tactics used by adversaries, such as embedding malicious drivers within legitimate applications or using other obscure locations for driver deployment. Moreover, if Sysmon logging for driver loads is not properly implemented, the rule may fail to trigger.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
