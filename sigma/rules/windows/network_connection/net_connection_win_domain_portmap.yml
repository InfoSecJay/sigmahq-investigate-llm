title: Network Communication Initiated To Portmap.IO Domain
id: 07837ab9-60e1-481f-a74d-c31fb496a94c
status: experimental
description: Detects an executable accessing the portmap.io domain, which could be
  a sign of forbidden C2 traffic or data exfiltration by malicious actors
references:
- https://portmap.io/
- https://github.com/rapid7/metasploit-framework/issues/11337
- https://pro.twitter.com/JaromirHorejsi/status/1795001037746761892/photo/2
author: Florian Roth (Nextron Systems)
date: 2024-05-31
tags:
- attack.t1041
- attack.command-and-control
- attack.t1090.002
- attack.exfiltration
logsource:
  category: network_connection
  product: windows
detection:
  selection:
    Initiated: 'true'
    DestinationHostname|endswith: '.portmap.io'
  condition: selection
falsepositives:
- Legitimate use of portmap.io domains
level: medium
notes: |
  ### Technical Context
  This detection rule focuses on identifying suspicious network communications initiated to the domain "portmap.io." This domain is known for its association with command-and-control (C2) activities and potentially malicious behavior such as data exfiltration. By monitoring network connection logs, specifically looking for instances where executables connect to this domain, the rule aims to highlight possible indicators of compromise (IoCs). The primary technical data sources involved in this rule are network connection logs generated by Windows systems. When an executable initiates a connection to any subdomain of "portmap.io," an alert is raised, prompting further investigation. This detection is mapped to the MITRE ATT&CK tactics of **Command and Control (T1041)** and **Exfiltration (T1090.002)**.
  ### Investigation Steps
  - **Check Network Traffic:** Utilize your NDR tool to get a broader view of the network traffic surrounding the time of the alert. Look for any other unusual or anomalous connections that coincide with the alert.
  - **Analyze Endpoint Activity:** Review the process creation logs in your EDR to determine which executable initiated the connection. This will help to understand whether it is a legitimate application or a potential threat.
  - **Review Firewall Logs:** Examine your NGFW logs to see if there were any other outbound connections to related or suspicious IPs or domains. This information can provide context and indicate whether this is part of a larger attack.
  - **Investigate User Context:** Use your Windows Security Logs to investigate user actions leading up to the alert. Check if the userâ€™s credentials were used to access systems that might be atypical for their role.
  ### Prioritization
  The alert is rated as medium severity because while communications to "portmap.io" can indicate malicious intent, legitimate applications may also use this domain, leading to potential false positives. Hence, thorough investigation is required to confirm malicious activities.
  ### Blind spots and Assumptions
  It is important to note that this rule may not trigger if the communication to "portmap.io" is encrypted; thus, visibility into the actual payload may be limited. Additionally, the rule assumes that outbound connections are intelligibly logged and that no network hygiene solutions (e.g., DNS filtering) block this domain. Attackers may also use domain generation algorithms to frequently change their C2 infrastructure, thereby evading detection.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
