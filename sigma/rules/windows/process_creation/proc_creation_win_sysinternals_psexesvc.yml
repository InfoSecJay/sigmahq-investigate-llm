title: PsExec Service Execution
id: fdfcbd78-48f1-4a4b-90ac-d82241e368c5
related:
- id: fa91cc36-24c9-41ce-b3c8-3bbc3f2f67ba
  type: obsolete
status: test
description: Detects launch of the PSEXESVC service, which means that this system
  was the target of a psexec remote execution
references:
- https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
- https://www.youtube.com/watch?v=ro2QuZTIMBM
author: Thomas Patzke, Romaissa Adjailia, Florian Roth (Nextron Systems)
date: 2017-06-12
modified: 2023-02-28
tags:
- attack.execution
logsource:
  category: process_creation
  product: windows
detection:
  selection:
  - Image: 'C:\Windows\PSEXESVC.exe'
  - OriginalFileName: 'psexesvc.exe'
  condition: selection
falsepositives:
- Legitimate administrative tasks
level: medium
notes: |
  ### Technical Context
  This Sigma rule detects the execution of the PsExec service by monitoring the process creation activity on Windows systems. PsExec is a command-line tool that allows users to execute processes on remote systems, effectively enabling remote access and control. The rule focuses on identifying instances where the PsExec service executable file (`C:\Windows\PSEXESVC.exe`) is launched, which could be indicative of unauthorized remote execution activities. The detection leverages Windows process creation logs and looks for specific attributes like the image path and the original filename. An alert generated by this rule can help security analysts recognize potential misuse of administrative tools commonly adopted by threat actors. This detection aligns with the MITRE ATT&CK framework under the execute tactic, particularly with the technique `T1059.001 
  - Command and Scripting Interpreter: PowerShell` and helps in identifying potentially malicious remote access attempts.
  ### Investigation Steps
  - **Examine EDR Alerts:** Review the EDR logs for additional context on process execution, focusing on parent and child process relationships to understand whether the PsExec service execution is part of a legitimate administrative task or indicative of a potential compromise.
  - **Correlate with Windows Logs:** Investigate Security Event logs for user logins around the same time as the PsExec execution. Look for any suspicious logins, especially from accounts that should not be performing remote executions.
  - **Analyze Network Connections:** Use network detection tools to check for unusual outbound connections originating from the device that initiated the PsExec execution. Look for connections to known malicious IP addresses or any unusual data transmissions.
  - **Review Administrative Actions:** Check for any legitimate administrative actions or maintenance tasks that may have involved PsExec. Itâ€™s crucial to compare this event with typical administrative activity in the environment to filter out false positives.
  ### Prioritization
  The alert has a medium severity level because while PsExec is a legitimate tool for system administration, its misuse can indicate unauthorized access or exploitation attempts. Quick action is warranted to verify the context and intent behind its use within enterprise environments.
  ### Blind Spots and Assumptions
  This rule may not trigger if the PsExec service is executed with a different file name or if an attacker uses a different method for remote execution. Additionally, legitimate administrative tasks could produce false positives, leading analysts to investigate incorrectly. Moreover, the detection relies heavily on proper logging configurations; if Windows Event Logging is not adequately enabled or configured, this detection may fail to fire.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and accuracy, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
