title: Sysinternals PsService Execution
id: 3371f518-5fe3-4cf6-a14b-2a0ae3fd8a4f
status: test
description: Detects usage of Sysinternals PsService which can be abused for service
  reconnaissance and tampering
references:
- https://learn.microsoft.com/en-us/sysinternals/downloads/psservice
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-06-16
modified: 2023-02-24
tags:
- attack.discovery
- attack.persistence
- attack.t1543.003
logsource:
  category: process_creation
  product: windows
detection:
  selection:
  - OriginalFileName: 'psservice.exe'
  - Image|endswith:
    - '\PsService.exe'
    - '\PsService64.exe'
  condition: selection
falsepositives:
- Legitimate use of PsService by an administrator
level: medium
notes: |
  n
  ### Technical Context
  The Sigma rule "Sysinternals PsService Execution" is designed to detect instances of the PsService tool, a part of the Sysinternals suite, which can be used by attackers for service reconnaissance or tampering with Windows services. When PsService is executed, it leverages the process creation logs of Windows, capturing specific attributes such as the image name and original file name of the process being run. This detection rule focuses on identifying the execution of 'psservice.exe' and its 64-bit counterpart 'psservice64.exe', providing visibility into potentially malicious activities that include service enumeration and manipulation. This rule aligns with the MITRE ATT&CK tactic of Discovery and Persistence, specifically technique T1543.003, which pertains to the creation or modification of services.
  ### Investigation Steps
  - **Check Process Details**: Investigate the process creation logs for 'psservice.exe' or 'psservice64.exe', noting the user and the time of execution to determine if it aligns with legitimate administrative activities.
  - **Correlate with User Activity**: Utilize EDR to correlate the PsService execution with the user's activity log, identifying any unauthorized or suspicious behavior associated with the command.
  - **Review Service Changes**: Inspect the services on the affected machine to identify any changes made by the PsService tool, checking for unwanted or unexpected modifications.
  - **Analyze Network Activity**: Utilize proxy and network logs to examine any outbound connections that may have happened concurrently with the PsService execution, as this could indicate broader malicious intentions.
  ### Prioritization
  The alert generated by this rule is considered medium severity, indicating that while it may not directly signify a breach, it points to potential reconnaissance or manipulation of services, which could be precursors to a more serious attack.
  ### Blind Spots and Assumptions
  This rule may not fire if the PsService tool is renamed or executed in a non-standard manner that doesn't match the specified conditions. Additionally, the detection relies heavily on proper logging configurations; if process creation logging is disabled or misconfigured, the rule would not be triggered. It is also assumed that legitimate administrative actions could trigger false positives, as administrators might use PsService for valid maintenance tasks.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and clarity, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
