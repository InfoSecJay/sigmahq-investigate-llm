title: DirLister Execution
id: b4dc61f5-6cce-468e-a608-b48b469feaa2
status: test
description: Detect the usage of "DirLister.exe" a utility for quickly listing folder
  or drive contents. It was seen used by BlackCat ransomware to create a list of accessible
  directories and files.
references:
- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1083/T1083.md
- https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/
author: frack113
date: 2022-08-20
modified: 2023-02-04
tags:
- attack.discovery
- attack.t1083
logsource:
  category: process_creation
  product: windows
detection:
  selection:
  - OriginalFileName: 'DirLister.exe'
  - Image|endswith: '\dirlister.exe'
  condition: selection
falsepositives:
- Legitimate use by users
level: low
notes: |
  ### Technical Context
  The "DirLister Execution" detection rule is designed to identify instances of the execution of "DirLister.exe," a utility commonly utilized for cataloging the contents of directories and drives. This tool has been observed being leveraged by BlackCat ransomware attackers to enumerate file systems prior to launching an attack, facilitating their malicious activities. The rule is effective in monitoring process creation logs generated by Windows systems and focuses on identifying the execution of files with the original filename "DirLister.exe" or the process name ending in "dirlister.exe." This behavior is classified under the MITRE ATT&CK tactics for Discovery, specifically the technique T1083, which entails file and directory discovery. By collecting alerts based on specific metadata of the executed processes, incident responders can investigate potential unauthorized usage or malicious reconnaissance efforts.
  ### Investigation Steps
  - **Check EDR Alerts:** Review endpoint detection and response (EDR) alerts for instances of "DirLister.exe" execution, noting the associated user and system. Cross-reference the execution time with known attack patterns or incident timelines.
  - **Analyze Process Tree:** Utilize the EDR to view the parent and child process relationships to ascertain if "DirLister.exe" was executed as part of a suspicious chain of events. Investigate if other known malicious activities preceded this process creation.
  - **Review Security Logs:** Inspect Windows Security event logs for unusual account activity or if any accounts executed "DirLister.exe." Focus on accounts with elevated privileges or those that are not typically associated with system administration tasks.
  - **Audit File Access Patterns:** Look into file access logs to determine what directories or files were listed by "DirLister.exe." Verify the access patterns against baseline activity to identify anomalies or unexpected access to sensitive information.
  ### Prioritization
  The alert generated by this rule is given a low severity level; however, it is essential to recognize that legitimate use by users can lead to false positives. Close scrutiny is necessary as benign executions may coexist with genuine malicious configurations.
  ### Blind Spots and Assumptions
  This detection rule may not fire in scenarios where the tool has been renamed or executed from a directory that is atypical or not monitored. Additionally, if an adversary uses techniques to obfuscate their actions (such as executing from a different process or using alternate means to list directories), this rule may not capture those activities. It is assumed that "DirLister.exe" is not commonly used in the environment, which could lead to missed detections in contexts where legitimate use is more prevalent than anticipated.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
