title: Suspicious Process Execution From Fake Recycle.Bin Folder
id: 5ce0f04e-3efc-42af-839d-5b3a543b76c0
related:
- id: cd8b36ac-8e4a-4c2f-a402-a29b8fbd5bca
  type: derived
status: test
description: Detects process execution from a fake recycle bin folder, often used
  to avoid security solution.
references:
- https://www.mandiant.com/resources/blog/infected-usb-steal-secrets
- https://unit42.paloaltonetworks.com/cloaked-ursa-phishing/
author: X__Junior (Nextron Systems)
date: 2023-07-12
modified: 2023-12-11
tags:
- attack.persistence
- attack.defense-evasion
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|contains:
            # e.g. C:\$RECYCLER.BIN
    - 'RECYCLERS.BIN\'
    - 'RECYCLER.BIN\'
  condition: selection
falsepositives:
- Unlikely
level: high
notes: |
  n
  ### Technical Context
  This detection rule identifies suspicious process executions originating from directories mimicking the Windows Recycle Bin, specifically targeting paths like `C:\$RECYCLER.BIN`. Malicious actors often leverage this tactic to obfuscate the actual nature of their executed processes, thereby evading security measures. The rule examines process creation logs to find any executables launched from these deceptive paths. The relevant data sources include Windows Event Logs related to process creation and Sysmon logs that capture detailed process execution records. This detection aligns with the MITRE ATT&CK tactics of Persistence and Defense Evasion, highlighting its significance in identifying potentially harmful activities that attempt to hide their presence on the system.
  ### Investigation Steps
  - **Review Process Execution Logs:** Check EDR for details on the processes that were executed from the identified paths, paying close attention to the command-line parameters used.
  - **Analyze Parent Process Relationships:** Utilize EDR to ascertain the parent process that initiated the suspicious execution, which could provide context on how the application was launched.
  - **Examine System Changes:** Investigate any notable changes in system files or registry entries that may have occurred around the same time as the suspicious process execution.
  - **Check Network Activity:** Use network logs (e.g., firewall or proxy logs) to determine if there were any unusual outbound connections made by the suspicious process, which could indicate exfiltration attempts.
  ### Prioritization
  Alerts generated by this rule should be treated as high severity due to the potential presence of sophisticated malware attempting to evade detection, which could lead to significant data breaches if not addressed swiftly.
  ### Blind Spots and Assumptions
  This rule is predicated on the assumption that the malicious actor uses a typical file path associated with the Recycle Bin. Should adversaries modify the file path or implement less common evasion techniques, the rule may not trigger. Additionally, this detection could be circumvented by processes executed from legitimate paths or through obfuscation techniques that don't use recognizable directories.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
