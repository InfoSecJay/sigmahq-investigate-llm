title: Audio Capture via PowerShell
id: 932fb0d8-692b-4b0f-a26e-5643a50fe7d6
status: test
description: Detects audio capture via PowerShell Cmdlet.
references:
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1123/T1123.md
- https://eqllib.readthedocs.io/en/latest/analytics/ab7a6ef4-0983-4275-a4f1-5c6bd3c31c23.html
- https://github.com/frgnca/AudioDeviceCmdlets
author: E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community,
  Nasreddine Bencherchali (Nextron Systems)
date: 2019-10-24
modified: 2023-04-06
tags:
- attack.collection
- attack.t1123
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    CommandLine|contains:
    - 'WindowsAudioDevice-Powershell-Cmdlet'
    - 'Toggle-AudioDevice'
    - 'Get-AudioDevice '
    - 'Set-AudioDevice '
    - 'Write-AudioDevice '
  condition: selection
falsepositives:
- Legitimate audio capture by legitimate user.
level: medium
notes: |
  ### Technical Context
  This Sigma rule is designed to detect potential malicious audio capture through a PowerShell cmdlet on Windows systems. The primary indicators include specific command line parameters that relate to the manipulation of audio devicesâ€”such as "Toggle-AudioDevice", "Get-AudioDevice", "Set-AudioDevice", and "Write-AudioDevice". The rule specifically monitors process creation logs, typically generated by Sysmon or the Windows Event Log, to identify instances where these commands are executed in a manner that suggests abuse. This behavior falls under the MITRE ATT&CK tactic of Collection, specifically technique T1123, which pertains to audio capture.
  In a typical enterprise environment, this monitoring can help identify unauthorized audio recording attempts that may pose privacy and security threats. The rule provides an automated way to detect these actions without requiring continuous manual oversight. By leveraging standard telemetry sources and focusing on command line inspections, the detection aims to provide incident responders with actionable alerts when suspicious audio capture attempts occur.
  ### Investigation Steps
  - **Verify Alert in EDR:** Begin by correlating the detected command line activity with process creation events in your EDR to confirm whether any unauthorized audio capture is taking place.
  - **Check associated processes:** Investigate the parent-child relationship of processes spawned by the detected audio cmdlet to determine if any malicious or unauthorized applications are associated with the alert.
  - **Review PowerShell logs:** Access PowerShell event logs to search for any additional suspicious commands or sessions that may indicate further malicious activity following the audio capture attempts.
  - **Assess user context and scope:** Evaluate the user account associated with the command execution to assess whether the activity falls within normal operating parameters or indicates potential account compromise.
  ### Prioritization
  This alert is classified as medium severity due to the potential risk of unauthorized audio recording, which can lead to privacy violations or data breaches if left unchecked. Prompt investigation is critical to understanding the context and ensuring that malicious actions are mitigated.
  ### Blind Spots and Assumptions
  This rule may not trigger in situations where legitimate users employ audio capture for authorized purposes, which may lead to false positives. Additionally, it may not detect advanced adversaries who could use obfuscation techniques to alter command line behavior or invoke audio capabilities through less detectable means or alternative tools. It also assumes that local privileges have not been bypassed or elevated to execute these commands unnoticed.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
