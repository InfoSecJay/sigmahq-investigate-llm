title: PUA - Rclone Execution
id: e37db05d-d1f9-49c8-b464-cee1a4b11638
related:
- id: a0d63692-a531-4912-ad39-4393325b2a9c
  type: obsolete
- id: cb7286ba-f207-44ab-b9e6-760d82b84253
  type: obsolete
status: test
description: Detects execution of RClone utility for exfiltration as used by various
  ransomwares strains like REvil, Conti, FiveHands, etc
references:
- https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/
- https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware
- https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a
- https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone
- https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html
author: Bhabesh Raj, Sittikorn S, Aaron Greetham (@beardofbinary) - NCC Group
date: 2021-05-10
modified: 2023-03-05
tags:
- attack.exfiltration
- attack.t1567.002
logsource:
  product: windows
  category: process_creation
detection:
  selection_specific_options:
    CommandLine|contains|all:
    - '--config '
    - '--no-check-certificate '
    - ' copy '
  selection_rclone_img:
  - Image|endswith: '\rclone.exe'
  - Description: 'Rsync for cloud storage'
  selection_rclone_cli:
    CommandLine|contains:
    - 'pass'
    - 'user'
    - 'copy'
    - 'sync'
    - 'config'
    - 'lsd'
    - 'remote'
    - 'ls'
    - 'mega'
    - 'pcloud'
    - 'ftp'
    - 'ignore-existing'
    - 'auto-confirm'
    - 'transfers'
    - 'multi-thread-streams'
    - 'no-check-certificate '
  condition: selection_specific_options or all of selection_rclone_*
fields:
- CommandLine
- ParentCommandLine
- Details
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The "PUA 
  - Rclone Execution" detection rule is designed to identify the execution of the Rclone utility, a versatile synchronization tool often leveraged for data exfiltration by various ransomware strains, including REvil, Conti, and FiveHands. This rule operates by analyzing process creation logs specifically for the invocation of Rclone with certain command-line parameters that are indicative of exfiltration activities. The relevant technical data sources include Windows Process Creation logs, where it looks for specific strings in the `CommandLine` field to pinpoint potentially malicious usage of Rclone. For instance, the rule flags command-line arguments that could suggest an exfiltration attempt, such as '--config', '--no-check-certificate', and various remote file handling operations. This aligns with the MITRE ATT&CK framework, specifically under the tactic of **Exfiltration** (T1567.002). 
  ### Investigation Steps
  - **Verify Process Creation:** Check for the creation of processes associated with Rclone by using EDR tools and filtering for `rclone.exe` in the process creation logs.
  - **Review Command-Line Parameters:** Examine the command-line arguments used during the execution of Rclone to identify any suspicious options that indicate data copying or synchronization.
  - **Inspect Network Traffic:** Utilize NDR tools to analyze outbound connections initiated by the Rclone process for any suspicious data transfers to unknown external IP addresses.
  - **Check For Known Indicators:** Cross-reference the parent process and any associated logs against known malicious indicators of compromise (IoCs) related to ransomware activity.
  ### Prioritization
  The severity level for alerts generated by this detection rule is classified as high due to the likelihood that the execution of Rclone, especially with specific command-line parameters, indicates an active attempt to exfiltrate sensitive data, posing a significant threat to the enterprise environment.
  ### Blind Spots and Assumptions
  This rule assumes that Rclone will only be executed in contexts that are not legitimate. It may not fire if Rclone is used in non-malicious scenarios, such as legitimate data transfer by authorized personnel. Additionally, command-line arguments may vary between legitimate and malicious uses, allowing adversaries to obfuscate their intent; thus, alerts may be missed if non-standard parameters are utilized. It's essential to recognize that security controls and processes might not encompass all operational patterns, which could lead to detection failures.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
