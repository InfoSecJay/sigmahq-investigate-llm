title: Rundll32 Execution Without Parameters
id: 5bb68627-3198-40ca-b458-49f973db8752
status: test
description: Detects rundll32 execution without parameters as observed when running
  Metasploit windows/smb/psexec exploit module
references:
- https://bczyz1.github.io/2021/01/30/psexec.html
author: Bartlomiej Czyz, Relativity
date: 2021-01-31
modified: 2023-02-28
tags:
- attack.lateral-movement
- attack.t1021.002
- attack.t1570
- attack.execution
- attack.t1569.002
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    CommandLine:
    - 'rundll32.exe'
    - 'rundll32'
  condition: selection
fields:
- ComputerName
- SubjectUserName
- CommandLine
- Image
- ParentImage
falsepositives:
- False positives may occur if a user called rundll32 from CLI with no options
level: high
notes: |
  n
  ### Technical Context
  This detection rule monitors for instances of `rundll32.exe` being executed without any command-line parameters. The use of `rundll32` without parameters is often associated with malicious activities, such as lateral movement exploits, particularly when conducted via tools like Metasploit. The command-line context can denote attempts to execute arbitrary code under the guise of a legitimate Windows process, making it crucial for defenders to identify these events. This rule utilizes process creation logs from Windows systems, specifically focusing on the command line that initiated the process. The rule aligns with the MITRE ATT&CK technique T1021.002 (Remote Services: Windows Admin Shares) and T1570 (Lateral Movement: Application Layer Protocol).
  ### Investigation Steps
  - **Verify Execution Context:** Review the `Process Creation` logs in EDR or Windows Security Event Logs for the user context and parent process that initiated the `rundll32.exe` call.
  - **Assess Command Line Parameters:** Check the Command Line field for any additional arguments that should typically accompany `rundll32.exe`. Investigate if the command was executed in an unconventional manner.
  - **Expand Investigation on Parent Process:** Track the parent process by reviewing associated logs. This could provide insights into how or why `rundll32.exe` was executed.
  - **Check Network Activity:** Utilize NDR solutions to monitor for any suspicious outbound connections made by the `rundll32.exe` process, which may indicate malicious intent.
  ### Prioritization
  Alerts generated by this rule are rated as high severity because executing `rundll32.exe` without parameters can indicate a potential exploitation attempt, warranting immediate investigation to mitigate possible security breaches.
  ### Blind Spots and Assumptions
  This detection rule may not fire if a legitimate user executes `rundll32.exe` without parameters from a command line interface. It also assumes that details within command-line execution logs are intact, as potential attackers may modify execution details or use alternative means to evade detection.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
