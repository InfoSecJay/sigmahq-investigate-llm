title: Suspicious Regsvr32 Execution From Remote Share
id: 88a87a10-384b-4ad7-8871-2f9bf9259ce5
status: test
description: Detects REGSVR32.exe to execute DLL hosted on remote shares
references:
- https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-10-31
tags:
- attack.defense-evasion
- attack.t1218.010
logsource:
  category: process_creation
  product: windows
detection:
  selection_img:
  - Image|endswith: '\regsvr32.exe'
  - OriginalFileName: '\REGSVR32.EXE'
  selection_cli:
    CommandLine|contains: ' \\\\'
  condition: all of selection_*
falsepositives:
- Unknown
# Decrease to medium if this is something common in your org
level: high
notes: |
  ### Technical Context
  The Sigma rule titled "Suspicious Regsvr32 Execution From Remote Share" is designed to detect the execution of the Windows utility **REGSVR32.exe** when it is invoked to execute a DLL hosted on remote shares. This technique is often used by attackers for evading detection while executing malicious code remotely. The rule specifically looks for signs of REGSVR32, by monitoring the process creation logs, focusing on instances where the command line includes a reference to UNC paths (e.g., `\\server\share`). 
  When an alert is generated by this rule, it may indicate a potential misuse of the REGSVR32 utility, thereby aligning with the MITRE ATT&CK technique T1218.010 (Signed Binary Proxy Execution). By leveraging the legitimate capabilities of Windows, threat actors can execute potentially harmful actions without raising immediate suspicion, making this detection rule critical for identifying malicious activities.
  ### Investigation Steps
  - **Check Process Creation Logs:** Verify the instances of `REGSVR32.exe` execution in the process creation logs to confirm whether they originate from remote shares.
  - **Analyze Command Line Parameters:** Examine the command line arguments used for each detected instance of `REGSVR32.exe` to identify any suspicious UNC paths pointing to remote locations.
  - **Cross-reference with EDR Data:** Utilize EDR telemetry to gather more context, including file hashes and patterns of behavior associated with the executed DLLs for a thorough assessment.
  - **Inspect Network Connections:** Review network logs for any outbound connections to the remote share that may correlate with the timing of the suspicious REGSVR32 executions.
  ### Prioritization
  The high severity level assigned to this alert underscores its potential threat; executing REGSVR32 from remote locations can indicate sophisticated attack methodologies aimed at bypassing defenses and deploying malicious payloads into the environment.
  ### Blind Spots and Assumptions
  There is a risk that legitimate administrative tasks or automated scripts utilizing REGSVR32 from remote locations may not be captured by this rule, resulting in false negatives. Moreover, the monitoring of command line parameters may not fire if attackers use other methods or system tools to directly load DLLs without invoking REGSVR32. It's also assumed that EDR and logging solutions are enabled and correctly configured across the entire environment.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
