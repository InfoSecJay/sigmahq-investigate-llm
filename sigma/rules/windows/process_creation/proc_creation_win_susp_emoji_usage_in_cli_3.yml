title: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3
id: f9578658-9e71-4711-b634-3f9b50cd3c06
status: test
description: Detects the usage of emojis in the command line, this could be a sign
  of potential defense evasion activity.
author: '@Kostastsale, @TheDFIRReport'
references:
- Internal Research
tags:
- attack.defense-evasion
date: 2022-12-05
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    CommandLine|contains:
    - '🦆'
    - '🦅'
    - '🦉'
    - '🦇'
    - '🐺'
    - '🐗'
    - '🐴'
    - '🦄'
    - '🐝'
    - '🪱'
    - '🐛'
    - '🦋'
    - '🐌'
    - '🐞'
    - '🐜'
    - '🪰'
    - '🪲'
    - '🪳'
    - '🦟'
    - '🦗'
    - '🕷'
    - '🕸'
    - '🦂'
    - '🐢'
    - '🐍'
    - '🦎'
    - '🦖'
    - '🦕'
    - '🐙'
    - '🦑'
    - '🦐'
    - '🦞'
    - '🦀'
    - '🪸'
    - '🐡'
    - '🐠'
    - '🐟'
    - '🐬'
    - '🐳'
    - '🐋'
    - '🦈'
    - '🐊'
    - '🐅'
    - '🐆'
    - '🦓'
    - '🦍'
    - '🦧'
    - '🦣'
    - '🐘'
    - '🦛'
    - '🦏'
    - '🐪'
    - '🐫'
    - '🦒'
    - '🦘'
    - '🦬'
    - '🐃'
    - '🐂'
    - '🐄'
    - '🐎'
    - '🐖'
    - '🐏'
    - '🐑'
    - '🦙'
    - '🐐'
    - '🦌'
    - '🐕'
    - '🐩'
    - '🦮'
    - '🐕‍🦺'
    - '🐈'
    - '🐈‍⬛'
    - '🪶'
    - '🐓'
    - '🦃'
    - '🦤'
    - '🦚'
    - '🦜'
    - '🦢'
    - '🦩'
    - '🕊'
    - '🐇'
    - '🦝'
    - '🦨'
    - '🦡'
    - '🦫'
    - '🦦'
    - '🦥'
    - '🐁'
    - '🐀'
    - '🐿'
    - '🦔'
    - '🐾'
    - '🐉'
    - '🐲'
    - '🌵'
    - '🎄'
    - '🌲'
    - '🌳'
    - '🌴'
    - '🪹'
    - '🪺'
    - '🪵'
    - '🌱'
    - '🌿'
    - '☘️'
    - '🍀'
    - '🎍'
    - '🪴'
    - '🎋'
    - '🍃'
    - '🍂'
    - '🍁'
    - '🍄'
    - '🐚'
    - '🪨'
    - '🌾'
    - '💐'
    - '🌷'
    - '🪷'
    - '🌹'
    - '🥀'
    - '🌺'
    - '🌸'
    - '🌼'
    - '🌻'
    - '🌞'
    - '🌝'
    - '🌛'
    - '🌜'
    - '🌚'
    - '🌕'
    - '🌖'
    - '🌗'
    - '🌘'
    - '🌑'
    - '🌒'
    - '🌓'
    - '🌔'
    - '🌙'
    - '🌎'
    - '🌍'
    - '🌏'
    - '🪐'
    - '💫'
    - '⭐️'
    - '🌟'
    - '✨'
    - '⚡️'
    - '☄️'
    - '💥'
    - '🔥'
    - '🌪'
    - '🌈'
    - '☀️'
    - '🌤'
    - '⛅️'
    - '🌥'
    - '☁️'
    - '🌦'
    - '🌧'
    - '⛈'
    - '🌩'
    - '🌨'
    - '❄️'
    - '☃️'
    - '⛄️'
    - '🌬'
    - '💨'
    - '💧'
    - '💦'
    - '🫧'
    - '☔️'
    - '☂️'
    - '🌊'
    - '🌫🍏'
    - '🍎'
    - '🍐'
    - '🍊'
    - '🍋'
    - '🍌'
    - '🍉'
    - '🍇'
    - '🍓'
    - '🫐'
    - '🍈'
    - '🍒'
    - '🍑'
    - '🥭'
    - '🍍'
    - '🥥'
    - '🥝'
    - '🍅'
    - '🍆'
    - '🥑'
    - '🥦'
    - '🥬'
    - '🥒'
    - '🌶'
    - '🫑'
    - '🌽'
    - '🥕'
    - '🫒'
    - '🧄'
    - '🧅'
    - '🥔'
    - '🍠'
    - '🫘'
    - '🥐'
    - '🥯'
    - '🍞'
    - '🥖'
    - '🥨'
    - '🧀'
    - '🥚'
    - '🍳'
    - '🧈'
    - '🥞'
    - '🧇'
    - '🥓'
    - '🥩'
    - '🍗'
    - '🍖'
    - '🦴'
    - '🌭'
    - '🍔'
    - '🍟'
    - '🍕'
    - '🫓'
    - '🥪'
    - '🥙'
    - '🧆'
    - '🌮'
    - '🌯'
    - '🫔'
    - '🥗'
    - '🥘'
    - '🫕'
    - '🥫'
    - '🍝'
    - '🍜'
    - '🍲'
    - '🍛'
    - '🍣'
    - '🍱'
    - '🥟'
    - '🦪'
    - '🍤'
    - '🍙'
    - '🍚'
    - '🍘'
    - '🍥'
    - '🥠'
    - '🥮'
    - '🍢'
    - '🍡'
    - '🍧'
    - '🍨'
    - '🍦'
    - '🥧'
    - '🧁'
    - '🍰'
    - '🎂'
    - '🍮'
    - '🍭'
    - '🍬'
    - '🍫'
    - '🍿'
    - '🍩'
    - '🍪'
    - '🌰'
    - '🥜'
    - '🍯'
    - '🥛'
    - '🍼'
    - '🫖'
    - '☕️'
    - '🍵'
    - '🧃'
    - '🥤'
    - '🧋'
    - '🫙'
    - '🍶'
    - '🍺'
    - '🍻'
    - '🥂'
    - '🍷'
    - '🫗'
    - '🥃'
    - '🍸'
    - '🍹'
    - '🧉'
    - '🍾'
    - '🧊'
    - '🥄'
    - '🍴'
    - '🍽'
    - '🥣'
    - '🥡'
    - '🥢'
    - '🧂'
    - '⚽️'
    - '🏀'
    - '🏈'
    - '⚾️'
    - '🥎'
    - '🎾'
    - '🏐'
    - '🏉'
    - '🥏'
    - '🎱'
    - '🪀'
    - '🏓'
    - '🏸'
    - '🏒'
    - '🏑'
    - '🥍'
    - '🏏'
    - '🪃'
    - '🥅'
    - '⛳️'
    - '🪁'
    - '🏹'
    - '🎣'
    - '🤿'
    - '🥊'
    - '🥋'
    - '🎽'
    - '🛹'
    - '🛼'
    - '🛷'
    - '⛸'
    - '🥌'
    - '🎿'
    - '⛷'
    - '🏂'
    - '🪂'
    - '🏋️‍♀️'
    - '🏋️'
    - '🏋️‍♂️'
    - '🤼‍♀️'
    - '🤼'
    - '🤼‍♂️'
    - '🤸‍♀️'
    - '🤸'
    - '🤸‍♂️'
    - '⛹️‍♀️'
    - '⛹️'
    - '⛹️‍♂️'
    - '🤺'
    - '🤾‍♀️'
    - '🤾'
    - '🤾‍♂️'
    - '🏌️‍♀️'
    - '🏌️'
    - '🏌️‍♂️'
    - '🏇'
    - '🧘‍♀️'
    - '🧘'
    - '🧘‍♂️'
    - '🏄‍♀️'
    - '🏄'
    - '🏄‍♂️'
    - '🏊‍♀️'
    - '🏊'
    - '🏊‍♂️'
    - '🤽‍♀️'
    - '🤽'
    - '🤽‍♂️'
    - '🚣‍♀️'
    - '🚣'
    - '🚣‍♂️'
    - '🧗‍♀️'
    - '🧗'
    - '🧗‍♂️'
    - '🚵‍♀️'
    - '🚵'
    - '🚵‍♂️'
    - '🚴‍♀️'
    - '🚴'
    - '🚴‍♂️'
    - '🏆'
    - '🥇'
    - '🥈'
    - '🥉'
    - '🏅'
    - '🎖'
    - '🏵'
    - '🎗'
    - '🎫'
    - '🎟'
    - '🎪'
    - '🤹'
    - '🤹‍♂️'
    - '🤹‍♀️'
    - '🎭'
    - '🩰'
    - '🎨'
    - '🎬'
    - '🎤'
    - '🎧'
    - '🎼'
    - '🎹'
    - '🥁'
    - '🪘'
    - '🎷'
    - '🎺'
    - '🪗'
    - '🎸'
    - '🪕'
    - '🎻'
    - '🎲'
    - '♟'
    - '🎯'
    - '🎳'
    - '🎮'
    - '🎰'
    - '🧩'
    - '🚗'
    - '🚕'
    - '🚙'
    - '🚌'
    - '🚎'
    - '🏎'
    - '🚓'
    - '🚑'
    - '🚒'
    - '🚐'
    - '🛻'
    - '🚚'
    - '🚛'
    - '🚜'
    - '🦯'
    - '🦽'
    - '🦼'
    - '🛴'
    - '🚲'
    - '🛵'
    - '🏍'
    - '🛺'
    - '🚨'
    - '🚔'
    - '🚍'
    - '🚘'
    - '🚖'
    - '🛞'
    - '🚡'
    - '🚠'
    - '🚟'
    - '🚃'
    - '🚋'
    - '🚞'
    - '🚝'
    - '🚄'
    - '🚅'
    - '🚈'
    - '🚂'
    - '🚆'
    - '🚇'
    - '🚊'
    - '🚉'
    - '✈️'
    - '🛫'
    - '🛬'
    - '🛩'
    - '💺'
    - '🛰'
    - '🚀'
    - '🛸'
    - '🚁'
    - '🛶'
    - '⛵️'
    - '🚤'
    - '🛥'
    - '🛳'
    - '⛴'
    - '🚢'
    - '⚓️'
    - '🛟'
    - '🪝'
    - '⛽️'
    - '🚧'
    - '🚦'
    - '🚥'
    - '🚏'
    - '🗺'
    - '🗿'
    - '🗽'
    - '🗼'
    - '🏰'
    - '🏯'
    - '🏟'
    - '🎡'
    - '🎢'
    - '🛝'
    - '🎠'
    - '⛲️'
    - '⛱'
    - '🏖'
    - '🏝'
    - '🏜'
    - '🌋'
    - '⛰'
    - '🏔'
    - '🗻'
    - '🏕'
    - '⛺️'
    - '🛖'
    - '🏠'
    - '🏡'
    - '🏘'
    - '🏚'
    - '🏗'
    - '🏭'
    - '🏢'
    - '🏬'
    - '🏣'
    - '🏤'
    - '🏥'
    - '🏦'
    - '🏨'
    - '🏪'
    - '🏫'
    - '🏩'
    - '💒'
    - '🏛'
    - '⛪️'
    - '🕌'
    - '🕍'
    - '🛕'
    - '🕋'
    - '⛩'
    - '🛤'
    - '🛣'
    - '🗾'
    - '🎑'
    - '🏞'
    - '🌅'
    - '🌄'
    - '🌠'
    - '🎇'
    - '🎆'
    - '🌇'
    - '🌆'
    - '🏙'
    - '🌃'
    - '🌌'
    - '🌉'
    - '🌁'
    - '⌚️'
    - '📱'
    - '📲'
    - '💻'
    - '⌨️'
    - '🖥'
    - '🖨'
    - '🖱'
    - '🖲'
    - '🕹'
    - '🗜'
    - '💽'
    - '💾'
    - '💿'
    - '📀'
    - '📼'
    - '📷'
    - '📸'
    - '📹'
    - '🎥'
    - '📽'
    - '🎞'
    - '📞'
    - '☎️'
    - '📟'
    - '📠'
    - '📺'
    - '📻'
    - '🎙'
    - '🎚'
    - '🎛'
    - '🧭'
    - '⏱'
    - '⏲'
    - '⏰'
    - '🕰'
    - '⌛️'
    - '⏳'
    - '📡'
    - '🔋'
    - '🪫'
    - '🔌'
    - '💡'
    - '🔦'
    - '🕯'
    - '🪔'
    - '🧯'
    - '🛢'
    - '💸'
    - '💵'
    - '💴'
    - '💶'
    - '💷'
    - '🪙'
    - '💰'
    - '💳'
    - '💎'
    - '⚖️'
    - '🪜'
    - '🧰'
    - '🪛'
    - '🔧'
    - '🔨'
    - '⚒'
    - '🛠'
    - '⛏'
    - '🪚'
    - '🔩'
    - '⚙️'
    - '🪤'
    - '🧱'
    - '⛓'
    - '🧲'
    - '🔫'
    - '💣'
    - '🧨'
    - '🪓'
    - '🔪'
    - '🗡'
    - '⚔️'
    - '🛡'
    - '🚬'
    - '⚰️'
    - '🪦'
    - '⚱️'
    - '🏺'
    - '🔮'
    - '📿'
    - '🧿'
    - '🪬'
    - '💈'
    - '⚗️'
    - '🔭'
    - '🔬'
    - '🕳'
    - '🩹'
    - '🩺'
    - '🩻'
    - '🩼'
    - '💊'
    - '💉'
    - '🩸'
    - '🧬'
    - '🦠'
    - '🧫'
    - '🧪'
    - '🌡'
    - '🧹'
    - '🪠'
    - '🧺'
    - '🧻'
    - '🚽'
    - '🚰'
    - '🚿'
    - '🛁'
    - '🛀'
    - '🧼'
    - '🪥'
    - '🪒'
    - '🧽'
    - '🪣'
    - '🧴'
    - '🛎'
    - '🔑'
    - '🗝'
    - '🚪'
    - '🪑'
    - '🛋'
    - '🛏'
    - '🛌'
    - '🧸'
    - '🪆'
    - '🖼'
    - '🪞'
    - '🪟'
    - '🛍'
    - '🛒'
    - '🎁'
    - '🎈'
    - '🎏'
    - '🎀'
    - '🪄'
    - '🪅'
    - '🎊'
    - '🎉'
    - '🪩'
    - '🎎'
    - '🏮'
    - '🎐'
    - '🧧'
    - '✉️'
    - '📩'
    - '📨'
    - '📧'
    - '💌'
    - '📥'
    - '📤'
    - '📦'
    - '🏷'
    - '🪧'
    - '📪'
    - '📫'
    - '📬'
    - '📭'
    - '📮'
    - '📯'
    - '📜'
    - '📃'
    - '📄'
    - '📑'
    - '🧾'
    - '📊'
    - '📈'
    - '📉'
    - '🗒'
    - '🗓'
    - '📆'
    - '📅'
    - '🗑'
    - '🪪'
    - '📇'
    - '🗃'
    - '🗳'
    - '🗄'
    - '📋'
    - '📁'
    - '📂'
    - '🗂'
    - '🗞'
    - '📰'
    - '📓'
    - '📔'
    - '📒'
    - '📕'
    - '📗'
    - '📘'
    - '📙'
    - '📚'
    - '📖'
    - '🔖'
    - '🧷'
    - '🔗'
    - '📎'
    - '🖇'
    - '📐'
    - '📏'
    - '🧮'
    - '📌'
    - '📍'
    - '✂️'
    - '🖊'
    - '🖋'
    - '✒️'
    - '🖌'
    - '🖍'
    - '📝'
    - '✏️'
    - '🔍'
    - '🔎'
    - '🔏'
    - '🔐'
    - '🔒'
    - '🔓❤️'
    - '🧡'
    - '💛'
    - '💚'
    - '💙'
    - '💜'
    - '🖤'
    - '🤍'
    - '🤎'
    - '❤️‍🔥'
    - '❤️‍🩹'
    - '💔'
    - '❣️'
    - '💕'
    - '💞'
    - '💓'
    - '💗'
    - '💖'
    - '💘'
    - '💝'
    - '💟'
    - '☮️'
    - '✝️'
    - '☪️'
    - '🕉'
    - '☸️'
    - '✡️'
    - '🔯'
    - '🕎'
    - '☯️'
    - '☦️'
    - '🛐'
    - '⛎'
    - '♈️'
    - '♉️'
    - '♊️'
    - '♋️'
    - '♌️'
    - '♍️'
    - '♎️'
    - '♏️'
    - '♐️'
    - '♑️'
    - '♒️'
    - '♓️'
    - '🆔'
    - '⚛️'
    - '🉑'
    - '☢️'
    - '☣️'
    - '📴'
    - '📳'
    - '🈶'
    - '🈚️'
    - '🈸'
    - '🈺'
    - '🈷️'
    - '✴️'
    - '🆚'
    - '💮'
    - '🉐'
    - '㊙️'
    - '㊗️'
    - '🈴'
    - '🈵'
    - '🈹'
    - '🈲'
    - '🅰️'
    - '🅱️'
    - '🆎'
    - '🆑'
    - '🅾️'
    - '🆘'
    - '❌'
    - '⭕️'
    - '🛑'
    - '⛔️'
    - '📛'
    - '🚫'
    - '💯'
    - '💢'
    - '♨️'
    - '🚷'
    - '🚯'
    - '🚳'
    - '🚱'
    - '🔞'
    - '📵'
    - '🚭'
    - '❗️'
    - '❕'
    - '❓'
    - '❔'
    - '‼️'
    - '⁉️'
    - '🔅'
    - '🔆'
    - '〽️'
    - '⚠️'
    - '🚸'
    - '🔱'
    - '⚜️'
    - '🔰'
    - '♻️'
    - '✅'
    - '🈯️'
    - '💹'
    - '❇️'
    - '✳️'
    - '❎'
    - '🌐'
    - '💠'
    - 'Ⓜ️'
    - '🌀'
    - '💤'
    - '🏧'
    - '🚾'
    - '♿️'
    - '🅿️'
    - '🛗'
    - '🈳'
    - '🈂️'
    - '🛂'
    - '🛃'
    - '🛄'
    - '🛅'
    - '🚹'
    - '🚺'
    - '🚼'
    - '⚧'
    - '🚻'
    - '🚮'
    - '🎦'
    - '📶'
    - '🈁'
    - '🔣'
    - 'ℹ️'
    - '🔤'
    - '🔡'
    - '🔠'
    - '🆖'
    - '🆗'
    - '🆙'
    - '🆒'
    - '🆕'
    - '🆓'
    - '0️⃣'
    - '1️⃣'
    - '2️⃣'
    - '3️⃣'
    - '4️⃣'
    - '5️⃣'
    - '6️⃣'
    - '7️⃣'
    - '8️⃣'
    - '9️⃣'
    - '🔟'
    - '🔢'
    - '#️⃣'
    - '*️⃣'
    - '⏏️'
    - '▶️'
    - '⏸'
    - '⏯'
    - '⏹'
    - '⏺'
    - '⏭'
    - '⏮'
    - '⏩'
    - '⏪'
    - '⏫'
    - '⏬'
    - '◀️'
    - '🔼'
    - '🔽'
    - '➡️'
    - '⬅️'
    - '⬆️'
    - '⬇️'
    - '↗️'
    - '↘️'
    - '↙️'
    - '↖️'
    - '↕️'
    - '↔️'
    - '↪️'
    - '↩️'
    - '⤴️'
    - '⤵️'
    - '🔀'
    - '🔁'
    - '🔂'
    - '🔄'
    - '🔃'
    - '🎵'
    - '🎶'
    - '➕'
    - '➖'
    - '➗'
    - '✖️'
    - '🟰'
    - '♾'
    - '💲'
    - '💱'
    - '™️'
    - '©️'
    - '®️'
    - '〰️'
    - '➰'
    - '➿'
    - '🔚'
    - '🔙'
    - '🔛'
    - '🔝'
    - '🔜'
    - '✔️'
    - '☑️'
    - '🔘'
    - '🔴'
    - '🟠'
    - '🟡'
    - '🟢'
    - '🔵'
    - '🟣'
    - '⚫️'
    - '⚪️'
    - '🟤'
    - '🔺'
    - '🔻'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  This detection rule identifies potential defense evasion tactics by monitoring the use of emojis in command-line arguments on Windows systems. The presence of emojis, which are generally uncommon in command-line operations, can indicate attempts to obscure commands or evade detection mechanisms employed by security products. The rule is triggered when command line inputs contain specific emoji characters, a comprehensive list of which is included in the rule configuration. Essential data sources for this detection are primarily process creation logs, which capture command-line arguments at the time a process is initiated.
  ### Investigation Steps
  - Use EDR tools to review the process creation logs around the time the alert was triggered to identify the initiating process and its command line details. 
  - Cross-reference the identified processes with recent application and system logs to check for any abnormal behavior or known malicious activity.
  - Examine network traffic logs from NDR solutions to determine if the alerting process established any external connections that could indicate further malicious activity.
  - Query proxy logs to investigate if the flagged command led to any web requests or data exfiltration that could tie back to potential threats.
