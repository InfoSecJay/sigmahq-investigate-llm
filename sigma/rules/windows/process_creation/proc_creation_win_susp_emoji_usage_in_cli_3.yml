title: Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3
id: f9578658-9e71-4711-b634-3f9b50cd3c06
status: test
description: Detects the usage of emojis in the command line, this could be a sign
  of potential defense evasion activity.
author: '@Kostastsale, @TheDFIRReport'
references:
- Internal Research
tags:
- attack.defense-evasion
date: 2022-12-05
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    CommandLine|contains:
    - '🦆'
    - '🦅'
    - '🦉'
    - '🦇'
    - '🐺'
    - '🐗'
    - '🐴'
    - '🦄'
    - '🐝'
    - '🪱'
    - '🐛'
    - '🦋'
    - '🐌'
    - '🐞'
    - '🐜'
    - '🪰'
    - '🪲'
    - '🪳'
    - '🦟'
    - '🦗'
    - '🕷'
    - '🕸'
    - '🦂'
    - '🐢'
    - '🐍'
    - '🦎'
    - '🦖'
    - '🦕'
    - '🐙'
    - '🦑'
    - '🦐'
    - '🦞'
    - '🦀'
    - '🪸'
    - '🐡'
    - '🐠'
    - '🐟'
    - '🐬'
    - '🐳'
    - '🐋'
    - '🦈'
    - '🐊'
    - '🐅'
    - '🐆'
    - '🦓'
    - '🦍'
    - '🦧'
    - '🦣'
    - '🐘'
    - '🦛'
    - '🦏'
    - '🐪'
    - '🐫'
    - '🦒'
    - '🦘'
    - '🦬'
    - '🐃'
    - '🐂'
    - '🐄'
    - '🐎'
    - '🐖'
    - '🐏'
    - '🐑'
    - '🦙'
    - '🐐'
    - '🦌'
    - '🐕'
    - '🐩'
    - '🦮'
    - '🐕‍🦺'
    - '🐈'
    - '🐈‍⬛'
    - '🪶'
    - '🐓'
    - '🦃'
    - '🦤'
    - '🦚'
    - '🦜'
    - '🦢'
    - '🦩'
    - '🕊'
    - '🐇'
    - '🦝'
    - '🦨'
    - '🦡'
    - '🦫'
    - '🦦'
    - '🦥'
    - '🐁'
    - '🐀'
    - '🐿'
    - '🦔'
    - '🐾'
    - '🐉'
    - '🐲'
    - '🌵'
    - '🎄'
    - '🌲'
    - '🌳'
    - '🌴'
    - '🪹'
    - '🪺'
    - '🪵'
    - '🌱'
    - '🌿'
    - '☘️'
    - '🍀'
    - '🎍'
    - '🪴'
    - '🎋'
    - '🍃'
    - '🍂'
    - '🍁'
    - '🍄'
    - '🐚'
    - '🪨'
    - '🌾'
    - '💐'
    - '🌷'
    - '🪷'
    - '🌹'
    - '🥀'
    - '🌺'
    - '🌸'
    - '🌼'
    - '🌻'
    - '🌞'
    - '🌝'
    - '🌛'
    - '🌜'
    - '🌚'
    - '🌕'
    - '🌖'
    - '🌗'
    - '🌘'
    - '🌑'
    - '🌒'
    - '🌓'
    - '🌔'
    - '🌙'
    - '🌎'
    - '🌍'
    - '🌏'
    - '🪐'
    - '💫'
    - '⭐️'
    - '🌟'
    - '✨'
    - '⚡️'
    - '☄️'
    - '💥'
    - '🔥'
    - '🌪'
    - '🌈'
    - '☀️'
    - '🌤'
    - '⛅️'
    - '🌥'
    - '☁️'
    - '🌦'
    - '🌧'
    - '⛈'
    - '🌩'
    - '🌨'
    - '❄️'
    - '☃️'
    - '⛄️'
    - '🌬'
    - '💨'
    - '💧'
    - '💦'
    - '🫧'
    - '☔️'
    - '☂️'
    - '🌊'
    - '🌫🍏'
    - '🍎'
    - '🍐'
    - '🍊'
    - '🍋'
    - '🍌'
    - '🍉'
    - '🍇'
    - '🍓'
    - '🫐'
    - '🍈'
    - '🍒'
    - '🍑'
    - '🥭'
    - '🍍'
    - '🥥'
    - '🥝'
    - '🍅'
    - '🍆'
    - '🥑'
    - '🥦'
    - '🥬'
    - '🥒'
    - '🌶'
    - '🫑'
    - '🌽'
    - '🥕'
    - '🫒'
    - '🧄'
    - '🧅'
    - '🥔'
    - '🍠'
    - '🫘'
    - '🥐'
    - '🥯'
    - '🍞'
    - '🥖'
    - '🥨'
    - '🧀'
    - '🥚'
    - '🍳'
    - '🧈'
    - '🥞'
    - '🧇'
    - '🥓'
    - '🥩'
    - '🍗'
    - '🍖'
    - '🦴'
    - '🌭'
    - '🍔'
    - '🍟'
    - '🍕'
    - '🫓'
    - '🥪'
    - '🥙'
    - '🧆'
    - '🌮'
    - '🌯'
    - '🫔'
    - '🥗'
    - '🥘'
    - '🫕'
    - '🥫'
    - '🍝'
    - '🍜'
    - '🍲'
    - '🍛'
    - '🍣'
    - '🍱'
    - '🥟'
    - '🦪'
    - '🍤'
    - '🍙'
    - '🍚'
    - '🍘'
    - '🍥'
    - '🥠'
    - '🥮'
    - '🍢'
    - '🍡'
    - '🍧'
    - '🍨'
    - '🍦'
    - '🥧'
    - '🧁'
    - '🍰'
    - '🎂'
    - '🍮'
    - '🍭'
    - '🍬'
    - '🍫'
    - '🍿'
    - '🍩'
    - '🍪'
    - '🌰'
    - '🥜'
    - '🍯'
    - '🥛'
    - '🍼'
    - '🫖'
    - '☕️'
    - '🍵'
    - '🧃'
    - '🥤'
    - '🧋'
    - '🫙'
    - '🍶'
    - '🍺'
    - '🍻'
    - '🥂'
    - '🍷'
    - '🫗'
    - '🥃'
    - '🍸'
    - '🍹'
    - '🧉'
    - '🍾'
    - '🧊'
    - '🥄'
    - '🍴'
    - '🍽'
    - '🥣'
    - '🥡'
    - '🥢'
    - '🧂'
    - '⚽️'
    - '🏀'
    - '🏈'
    - '⚾️'
    - '🥎'
    - '🎾'
    - '🏐'
    - '🏉'
    - '🥏'
    - '🎱'
    - '🪀'
    - '🏓'
    - '🏸'
    - '🏒'
    - '🏑'
    - '🥍'
    - '🏏'
    - '🪃'
    - '🥅'
    - '⛳️'
    - '🪁'
    - '🏹'
    - '🎣'
    - '🤿'
    - '🥊'
    - '🥋'
    - '🎽'
    - '🛹'
    - '🛼'
    - '🛷'
    - '⛸'
    - '🥌'
    - '🎿'
    - '⛷'
    - '🏂'
    - '🪂'
    - '🏋️‍♀️'
    - '🏋️'
    - '🏋️‍♂️'
    - '🤼‍♀️'
    - '🤼'
    - '🤼‍♂️'
    - '🤸‍♀️'
    - '🤸'
    - '🤸‍♂️'
    - '⛹️‍♀️'
    - '⛹️'
    - '⛹️‍♂️'
    - '🤺'
    - '🤾‍♀️'
    - '🤾'
    - '🤾‍♂️'
    - '🏌️‍♀️'
    - '🏌️'
    - '🏌️‍♂️'
    - '🏇'
    - '🧘‍♀️'
    - '🧘'
    - '🧘‍♂️'
    - '🏄‍♀️'
    - '🏄'
    - '🏄‍♂️'
    - '🏊‍♀️'
    - '🏊'
    - '🏊‍♂️'
    - '🤽‍♀️'
    - '🤽'
    - '🤽‍♂️'
    - '🚣‍♀️'
    - '🚣'
    - '🚣‍♂️'
    - '🧗‍♀️'
    - '🧗'
    - '🧗‍♂️'
    - '🚵‍♀️'
    - '🚵'
    - '🚵‍♂️'
    - '🚴‍♀️'
    - '🚴'
    - '🚴‍♂️'
    - '🏆'
    - '🥇'
    - '🥈'
    - '🥉'
    - '🏅'
    - '🎖'
    - '🏵'
    - '🎗'
    - '🎫'
    - '🎟'
    - '🎪'
    - '🤹'
    - '🤹‍♂️'
    - '🤹‍♀️'
    - '🎭'
    - '🩰'
    - '🎨'
    - '🎬'
    - '🎤'
    - '🎧'
    - '🎼'
    - '🎹'
    - '🥁'
    - '🪘'
    - '🎷'
    - '🎺'
    - '🪗'
    - '🎸'
    - '🪕'
    - '🎻'
    - '🎲'
    - '♟'
    - '🎯'
    - '🎳'
    - '🎮'
    - '🎰'
    - '🧩'
    - '🚗'
    - '🚕'
    - '🚙'
    - '🚌'
    - '🚎'
    - '🏎'
    - '🚓'
    - '🚑'
    - '🚒'
    - '🚐'
    - '🛻'
    - '🚚'
    - '🚛'
    - '🚜'
    - '🦯'
    - '🦽'
    - '🦼'
    - '🛴'
    - '🚲'
    - '🛵'
    - '🏍'
    - '🛺'
    - '🚨'
    - '🚔'
    - '🚍'
    - '🚘'
    - '🚖'
    - '🛞'
    - '🚡'
    - '🚠'
    - '🚟'
    - '🚃'
    - '🚋'
    - '🚞'
    - '🚝'
    - '🚄'
    - '🚅'
    - '🚈'
    - '🚂'
    - '🚆'
    - '🚇'
    - '🚊'
    - '🚉'
    - '✈️'
    - '🛫'
    - '🛬'
    - '🛩'
    - '💺'
    - '🛰'
    - '🚀'
    - '🛸'
    - '🚁'
    - '🛶'
    - '⛵️'
    - '🚤'
    - '🛥'
    - '🛳'
    - '⛴'
    - '🚢'
    - '⚓️'
    - '🛟'
    - '🪝'
    - '⛽️'
    - '🚧'
    - '🚦'
    - '🚥'
    - '🚏'
    - '🗺'
    - '🗿'
    - '🗽'
    - '🗼'
    - '🏰'
    - '🏯'
    - '🏟'
    - '🎡'
    - '🎢'
    - '🛝'
    - '🎠'
    - '⛲️'
    - '⛱'
    - '🏖'
    - '🏝'
    - '🏜'
    - '🌋'
    - '⛰'
    - '🏔'
    - '🗻'
    - '🏕'
    - '⛺️'
    - '🛖'
    - '🏠'
    - '🏡'
    - '🏘'
    - '🏚'
    - '🏗'
    - '🏭'
    - '🏢'
    - '🏬'
    - '🏣'
    - '🏤'
    - '🏥'
    - '🏦'
    - '🏨'
    - '🏪'
    - '🏫'
    - '🏩'
    - '💒'
    - '🏛'
    - '⛪️'
    - '🕌'
    - '🕍'
    - '🛕'
    - '🕋'
    - '⛩'
    - '🛤'
    - '🛣'
    - '🗾'
    - '🎑'
    - '🏞'
    - '🌅'
    - '🌄'
    - '🌠'
    - '🎇'
    - '🎆'
    - '🌇'
    - '🌆'
    - '🏙'
    - '🌃'
    - '🌌'
    - '🌉'
    - '🌁'
    - '⌚️'
    - '📱'
    - '📲'
    - '💻'
    - '⌨️'
    - '🖥'
    - '🖨'
    - '🖱'
    - '🖲'
    - '🕹'
    - '🗜'
    - '💽'
    - '💾'
    - '💿'
    - '📀'
    - '📼'
    - '📷'
    - '📸'
    - '📹'
    - '🎥'
    - '📽'
    - '🎞'
    - '📞'
    - '☎️'
    - '📟'
    - '📠'
    - '📺'
    - '📻'
    - '🎙'
    - '🎚'
    - '🎛'
    - '🧭'
    - '⏱'
    - '⏲'
    - '⏰'
    - '🕰'
    - '⌛️'
    - '⏳'
    - '📡'
    - '🔋'
    - '🪫'
    - '🔌'
    - '💡'
    - '🔦'
    - '🕯'
    - '🪔'
    - '🧯'
    - '🛢'
    - '💸'
    - '💵'
    - '💴'
    - '💶'
    - '💷'
    - '🪙'
    - '💰'
    - '💳'
    - '💎'
    - '⚖️'
    - '🪜'
    - '🧰'
    - '🪛'
    - '🔧'
    - '🔨'
    - '⚒'
    - '🛠'
    - '⛏'
    - '🪚'
    - '🔩'
    - '⚙️'
    - '🪤'
    - '🧱'
    - '⛓'
    - '🧲'
    - '🔫'
    - '💣'
    - '🧨'
    - '🪓'
    - '🔪'
    - '🗡'
    - '⚔️'
    - '🛡'
    - '🚬'
    - '⚰️'
    - '🪦'
    - '⚱️'
    - '🏺'
    - '🔮'
    - '📿'
    - '🧿'
    - '🪬'
    - '💈'
    - '⚗️'
    - '🔭'
    - '🔬'
    - '🕳'
    - '🩹'
    - '🩺'
    - '🩻'
    - '🩼'
    - '💊'
    - '💉'
    - '🩸'
    - '🧬'
    - '🦠'
    - '🧫'
    - '🧪'
    - '🌡'
    - '🧹'
    - '🪠'
    - '🧺'
    - '🧻'
    - '🚽'
    - '🚰'
    - '🚿'
    - '🛁'
    - '🛀'
    - '🧼'
    - '🪥'
    - '🪒'
    - '🧽'
    - '🪣'
    - '🧴'
    - '🛎'
    - '🔑'
    - '🗝'
    - '🚪'
    - '🪑'
    - '🛋'
    - '🛏'
    - '🛌'
    - '🧸'
    - '🪆'
    - '🖼'
    - '🪞'
    - '🪟'
    - '🛍'
    - '🛒'
    - '🎁'
    - '🎈'
    - '🎏'
    - '🎀'
    - '🪄'
    - '🪅'
    - '🎊'
    - '🎉'
    - '🪩'
    - '🎎'
    - '🏮'
    - '🎐'
    - '🧧'
    - '✉️'
    - '📩'
    - '📨'
    - '📧'
    - '💌'
    - '📥'
    - '📤'
    - '📦'
    - '🏷'
    - '🪧'
    - '📪'
    - '📫'
    - '📬'
    - '📭'
    - '📮'
    - '📯'
    - '📜'
    - '📃'
    - '📄'
    - '📑'
    - '🧾'
    - '📊'
    - '📈'
    - '📉'
    - '🗒'
    - '🗓'
    - '📆'
    - '📅'
    - '🗑'
    - '🪪'
    - '📇'
    - '🗃'
    - '🗳'
    - '🗄'
    - '📋'
    - '📁'
    - '📂'
    - '🗂'
    - '🗞'
    - '📰'
    - '📓'
    - '📔'
    - '📒'
    - '📕'
    - '📗'
    - '📘'
    - '📙'
    - '📚'
    - '📖'
    - '🔖'
    - '🧷'
    - '🔗'
    - '📎'
    - '🖇'
    - '📐'
    - '📏'
    - '🧮'
    - '📌'
    - '📍'
    - '✂️'
    - '🖊'
    - '🖋'
    - '✒️'
    - '🖌'
    - '🖍'
    - '📝'
    - '✏️'
    - '🔍'
    - '🔎'
    - '🔏'
    - '🔐'
    - '🔒'
    - '🔓❤️'
    - '🧡'
    - '💛'
    - '💚'
    - '💙'
    - '💜'
    - '🖤'
    - '🤍'
    - '🤎'
    - '❤️‍🔥'
    - '❤️‍🩹'
    - '💔'
    - '❣️'
    - '💕'
    - '💞'
    - '💓'
    - '💗'
    - '💖'
    - '💘'
    - '💝'
    - '💟'
    - '☮️'
    - '✝️'
    - '☪️'
    - '🕉'
    - '☸️'
    - '✡️'
    - '🔯'
    - '🕎'
    - '☯️'
    - '☦️'
    - '🛐'
    - '⛎'
    - '♈️'
    - '♉️'
    - '♊️'
    - '♋️'
    - '♌️'
    - '♍️'
    - '♎️'
    - '♏️'
    - '♐️'
    - '♑️'
    - '♒️'
    - '♓️'
    - '🆔'
    - '⚛️'
    - '🉑'
    - '☢️'
    - '☣️'
    - '📴'
    - '📳'
    - '🈶'
    - '🈚️'
    - '🈸'
    - '🈺'
    - '🈷️'
    - '✴️'
    - '🆚'
    - '💮'
    - '🉐'
    - '㊙️'
    - '㊗️'
    - '🈴'
    - '🈵'
    - '🈹'
    - '🈲'
    - '🅰️'
    - '🅱️'
    - '🆎'
    - '🆑'
    - '🅾️'
    - '🆘'
    - '❌'
    - '⭕️'
    - '🛑'
    - '⛔️'
    - '📛'
    - '🚫'
    - '💯'
    - '💢'
    - '♨️'
    - '🚷'
    - '🚯'
    - '🚳'
    - '🚱'
    - '🔞'
    - '📵'
    - '🚭'
    - '❗️'
    - '❕'
    - '❓'
    - '❔'
    - '‼️'
    - '⁉️'
    - '🔅'
    - '🔆'
    - '〽️'
    - '⚠️'
    - '🚸'
    - '🔱'
    - '⚜️'
    - '🔰'
    - '♻️'
    - '✅'
    - '🈯️'
    - '💹'
    - '❇️'
    - '✳️'
    - '❎'
    - '🌐'
    - '💠'
    - 'Ⓜ️'
    - '🌀'
    - '💤'
    - '🏧'
    - '🚾'
    - '♿️'
    - '🅿️'
    - '🛗'
    - '🈳'
    - '🈂️'
    - '🛂'
    - '🛃'
    - '🛄'
    - '🛅'
    - '🚹'
    - '🚺'
    - '🚼'
    - '⚧'
    - '🚻'
    - '🚮'
    - '🎦'
    - '📶'
    - '🈁'
    - '🔣'
    - 'ℹ️'
    - '🔤'
    - '🔡'
    - '🔠'
    - '🆖'
    - '🆗'
    - '🆙'
    - '🆒'
    - '🆕'
    - '🆓'
    - '0️⃣'
    - '1️⃣'
    - '2️⃣'
    - '3️⃣'
    - '4️⃣'
    - '5️⃣'
    - '6️⃣'
    - '7️⃣'
    - '8️⃣'
    - '9️⃣'
    - '🔟'
    - '🔢'
    - '#️⃣'
    - '*️⃣'
    - '⏏️'
    - '▶️'
    - '⏸'
    - '⏯'
    - '⏹'
    - '⏺'
    - '⏭'
    - '⏮'
    - '⏩'
    - '⏪'
    - '⏫'
    - '⏬'
    - '◀️'
    - '🔼'
    - '🔽'
    - '➡️'
    - '⬅️'
    - '⬆️'
    - '⬇️'
    - '↗️'
    - '↘️'
    - '↙️'
    - '↖️'
    - '↕️'
    - '↔️'
    - '↪️'
    - '↩️'
    - '⤴️'
    - '⤵️'
    - '🔀'
    - '🔁'
    - '🔂'
    - '🔄'
    - '🔃'
    - '🎵'
    - '🎶'
    - '➕'
    - '➖'
    - '➗'
    - '✖️'
    - '🟰'
    - '♾'
    - '💲'
    - '💱'
    - '™️'
    - '©️'
    - '®️'
    - '〰️'
    - '➰'
    - '➿'
    - '🔚'
    - '🔙'
    - '🔛'
    - '🔝'
    - '🔜'
    - '✔️'
    - '☑️'
    - '🔘'
    - '🔴'
    - '🟠'
    - '🟡'
    - '🟢'
    - '🔵'
    - '🟣'
    - '⚫️'
    - '⚪️'
    - '🟤'
    - '🔺'
    - '🔻'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The Sigma rule titled **"Potential Defense Evasion Activity Via Emoji Usage In CommandLine"** aims to identify unusual command line activity that includes emojis. Emojis in command line arguments may indicate an attempt to obfuscate malicious behavior or evade detection, particularly as traditional security solutions may not recognize such use as malicious. The rule specifically monitors process creation events where the command line includes a set of predefined emojis, suggesting that an adversary might be attempting to manipulate processes in a stealthy manner. This detection leverages process creation logs—captured through Windows Sysmon, a logging tool that provides detailed visibility into system activities. The associated MITRE ATT&CK tactic for this rule is **Defense Evasion**, with the relevant technique being **Obfuscated Files or Information** (T1027).
  ### Investigation Steps
  - **Review Process Creation Events**: Use EDR tools to examine the process creation logs associated with the alert, focusing on command line arguments and parent-child relationships to identify the origin of the commands containing emojis.
    
  - **Analyze Command Context**: Investigate the command execution context to determine if the process originated from a known application or if it appears anomalous. Cross-reference with user activity logs for potential misuse cases.
  - **Correlate with Other Logs**: Check other telemetry sources, including network connections and file access events, for suspicious activity related to the identified processes. This could help in tracking down broader malicious behaviors.
  - **Assess Scope of Activity**: Evaluate if the identified command line usage is part of a larger pattern of evasion tactics by searching your SIEM for similar instances of emoji usage in command line arguments across different systems.
  ### Prioritization
  The alert is categorized as high severity because the presence of emojis in command line arguments can indicate a significant deviation from normal usage patterns, suggesting possible malicious intent to obfuscate or disguise actions within a system.
  ### Blind spots and Assumptions
  This rule assumes that all emoji-using command lines are potentially malicious, which may include benign applications that may use emojis legitimately. Additionally, the detection primarily focuses on certain predefined emojis; therefore, an adversary could bypass this detection by using other methods or characters that do not match the rule's parameters. Furthermore, if logging is misconfigured or if Sysmon is not deployed correctly, the rule may fail to detect certain malicious activities.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
