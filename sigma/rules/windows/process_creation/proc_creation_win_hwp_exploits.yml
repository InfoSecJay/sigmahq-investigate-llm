title: Suspicious HWP Sub Processes
id: 023394c4-29d5-46ab-92b8-6a534c6f447b
status: test
description: Detects suspicious Hangul Word Processor (Hanword) sub processes that
  could indicate an exploitation
references:
- https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/
- https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1
- https://twitter.com/cyberwar_15/status/1187287262054076416
- https://blog.alyac.co.kr/1901
- https://en.wikipedia.org/wiki/Hangul_(word_processor)
author: Florian Roth (Nextron Systems)
date: 2019-10-24
modified: 2021-11-27
tags:
- attack.initial-access
- attack.t1566.001
- attack.execution
- attack.t1203
- attack.t1059.003
- attack.g0032
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    ParentImage|endswith: '\Hwp.exe'
    Image|endswith: '\gbb.exe'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The "Suspicious HWP Sub Processes" detection rule is designed to identify potential exploitation attempts involving the Hangul Word Processor (HWP) application, widely used in South Korea. This rule pays particular attention to the creation of subprocesses by the HWP executable (Hwp.exe) that may indicate malicious activity. It monitors process creation logs to flag instances where a process named "gbb.exe" is spawned as a child process of Hwp.exe. Given that HWP files have been linked to various types of attacks, including exploitation through macros and malicious document structures, detecting these subprocesses is critical for early detection of potential compromise. By focusing on the relationship between these processes, the rule aims to help SOC analysts uncover and mitigate threats related to document-based exploitation strategies.
  ### Investigation Steps
  - Review process creation logs in your EDR to confirm the execution of `gbb.exe` as a subprocess of `Hwp.exe`, noting the timestamps and user context to assess the legitimacy of the event.
  - Use threat intelligence tools or public malware analysis services to check whether the observed `gbb.exe` file exhibits any known malicious behavior or is flagged in the security community.
  - Analyze network traffic through your NDR or proxy logs for any unusual outbound connections initiated by `gbb.exe`, which can indicate data exfiltration attempts or command-and-control communications.
  - Query endpoint protection solutions to determine if `gbb.exe` is flagged or quarantined by AV tools, and assess the historical context of the parent process to provide further insights into its behavior and intent.
