title: Visual Studio NodejsTools PressAnyKey Renamed Execution
id: 65c3ca2c-525f-4ced-968e-246a713d164f
related:
- id: a20391f8-76fb-437b-abc0-dba2df1952c6
  type: similar
status: test
description: Detects renamed execution of "Microsoft.NodejsTools.PressAnyKey.exe",
  which can be abused as a LOLBIN to execute arbitrary binaries
references:
- https://twitter.com/mrd0x/status/1463526834918854661
- https://gist.github.com/nasbench/a989ce64cefa8081bd50cf6ad8c491b5
author: Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)
date: 2023-04-11
tags:
- attack.execution
- attack.defense-evasion
- attack.t1218
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    OriginalFileName: 'Microsoft.NodejsTools.PressAnyKey.exe'
  filter_main_legit_name:
    Image|endswith: '\Microsoft.NodejsTools.PressAnyKey.exe'
  condition: selection and not 1 of filter_main_*
falsepositives:
- Unknown
level: medium
notes: |
  n
  ### Technical Context
  The Sigma rule titled "Visual Studio NodejsTools PressAnyKey Renamed Execution" is designed to detect the unauthorized execution of a renamed legitimate executable, specifically "Microsoft.NodejsTools.PressAnyKey.exe." This executable is often exploited by adversaries as a Living Off the Land Binary (LOLBIN) to execute arbitrary commands or binaries, evading traditional security measures. The rule identifies instances where this executable retains an identity tied to its legitimate name while potentially being used in a malicious manner—this includes scenarios where the file might be renamed as part of an attack strategy. The primary data sources leveraged for this detection include Windows process creation logs that record details about processes initiated on the system, such as executable names and command-line parameters. This detection aligns with the MITRE ATT&CK framework’s **Execution** tactic (T1218), which focuses on using legitimate tools for executing code or carrying out malicious activities.
  ### Investigation Steps
  - **Check Process Creation Logs:** Search the EDR system for process creation logs that show any recent instantiations of "Microsoft.NodejsTools.PressAnyKey.exe" or any similarly named processes for potential deviations from expected behavior.
    
  - **Analyze Command-Line Parameters:** Review the command-line parameters used in the detected instances to identify any suspicious or unauthorized actions initiated via this executable.
  - **Examine Parent-Child Process Relationships:** Use EDR tools to investigate the parent processes that spawned the identified instances, as malicious activities may be initiated by other potentially compromised processes.
  - **Cross-Reference with Security Solutions:** Verify the legitimacy of the alerts by comparing data from proxy, VPN, and cloud logs to identify any anomalous remote accesses or communications associated with the detected execution.
  ### Prioritization
  Alerts generated by this rule should be prioritized as **medium severity**. They indicate potential abuse of a trusted application for malicious activity, warranting timely investigation to prevent possible exploitation or data exfiltration.
  ### Blind Spots and Assumptions
  This rule may not fire in scenarios where the executable is executed under a different name or when an adversary uses obfuscation techniques to alter the characteristics of the malicious activity. Additionally, environmental limitations, such as the unavailability of comprehensive process creation logging for all endpoints or delayed log ingestion, may result in missed detections. It is assumed that defenders will rely on consistent monitoring and timely updates of software to minimize these gaps.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
