title: Suspicious File Characteristics Due to Missing Fields
id: 9637e8a5-7131-4f7f-bdc7-2b05d8670c43
status: test
description: Detects Executables in the Downloads folder without FileVersion,Description,Product,Company
  likely created with py2exe
references:
- https://securelist.com/muddywater/88059/
- https://www.virustotal.com/#/file/276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb/detection
author: Markus Neis, Sander Wiebing
date: 2018-11-22
modified: 2022-10-09
tags:
- attack.execution
- attack.t1059.006
logsource:
  product: windows
  category: process_creation
detection:
  selection1:
    Description: '\?'
    FileVersion: '\?'
  selection2:
    Description: '\?'
    Product: '\?'
  selection3:
    Description: '\?'
    Company: '\?'
  folder:
    Image|contains: '\Downloads\'
  condition: (selection1 or selection2 or selection3) and folder
fields:
- CommandLine
- ParentCommandLine
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  This detection rule is designed to identify executables located within the Downloads folder that lack essential file metadata fieldsâ€”specifically, FileVersion, Description, Product, and Company. These missing fields are indicative of files that may have been generated by tools such as py2exe, which are frequently used by attackers to create standalone executables that do not possess recognizable file attributes. This behavior aligns with the MITRE ATT&CK technique for Execution (T1059.006), which includes scripting and bypassing application controls. The rule relies on Windows process creation logs to extract relevant information about the attributes of executable files, thereby allowing analysts to flag potentially malicious files for further investigation based on their incomplete metadata.
  ### Investigation Steps
  - **Examine Process Creation Logs**: Utilize EDR solutions to review process creation logs for suspicious executables originating from the Downloads folder, focusing on those without the specified metadata fields.
  - **Analyze Command Line Arguments**: Check the command line and parent command line fields in the process creation logs to determine how the flagged executables were invoked, which may provide insight into potential malicious activity.
  - **Review Antivirus Reports**: Consult AV logs to see if the detected executables have been flagged for malware. This can indicate whether the alert correlates with known threats.
  - **Explore Network Activity**: Utilize NDR logs to investigate any outbound network connections made by the suspicious executables, which can further help determine if the file is part of a broader attack pattern.
  ### Prioritization
  The alert is assigned a medium severity level because executables lacking critical file metadata can indicate potentially harmful activity. While not all such files are malicious, their presence in the Downloads folder warrants further scrutiny to prevent potential compromise.
  ### Blind Spots and Assumptions
  This rule may not trigger in environments where legitimate applications routinely lack file metadata, leading to false positives. Additionally, it assumes that compromised systems maintain standard configurations where such executions are loggable. Adversaries might employ tactics to obfuscate file creation or manipulate metadata to evade detection, thereby preventing the rule from activating. Furthermore, benign applications created in this manner may exist in a system, which could lead to unnecessary alerts if not properly contextualized.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
