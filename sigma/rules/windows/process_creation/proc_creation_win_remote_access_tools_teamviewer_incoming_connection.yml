title: Remote Access Tool - Team Viewer Session Started On Windows Host
id: ab70c354-d9ac-4e11-bbb6-ec8e3b153357
related:
- id: 1f6b8cd4-3e60-47cc-b282-5aa1cbc9182d
  type: similar
- id: f459ccb4-9805-41ea-b5b2-55e279e2424a
  type: similar
status: test
description: |
  Detects the command line executed when TeamViewer starts a session started by a remote host.
  Once a connection has been started, an investigator can verify the connection details by viewing the "incoming_connections.txt" log file in the TeamViewer folder.
references:
- Internal Research
author: Josh Nickels, Qi Nan
date: 2024-03-11
tags:
- attack.initial-access
- attack.t1133
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image: 'TeamViewer_Desktop.exe'
    ParentImage: 'TeamViewer_Service.exe'
    CommandLine|endswith: 'TeamViewer_Desktop.exe --IPCport 5939 --Module 1'
  condition: selection
falsepositives:
- Legitimate usage of TeamViewer
level: low
notes: |
  ### Technical Context
  This detection rule monitors for the execution of TeamViewer, a popular remote access tool, specifically when a session is initiated on a Windows host. The rule looks for process creation events where `TeamViewer_Desktop.exe` is triggered by `TeamViewer_Service.exe` with a specific command line that indicates an incoming session (`--IPCport 5939 --Module 1`). The technical data sources involved include Windows event logs related to process creation, allowing SOC analysts to pinpoint when unauthorized remote access sessions may occur. This detection aligns with MITRE ATT&CK's tactic "Initial Access" and technique T1133, which refers to "External Remote Services", highlighting the importance of monitoring remote access methods that could facilitate unauthorized entry into the network environment.
  ### Investigation Steps
  - **Check Process Execution:** Review the process creation logs in your EDR solution to confirm if the TeamViewer application was started as specified. Investigate the parent process and ensure it is a legitimate service instance.
  - **Examine Command Line Usage:** Use the SIEM to inspect the command line arguments associated with the logged instance of TeamViewer. Ensure that the parameters match the expected command and are not altered in a suspicious way.
  - **Review Connection Logs:** Access the TeamViewer log files located in the installation directory, specifically `incoming_connections.txt`, to verify connection details and assess the legitimacy of any incoming requests. This can provide insightful context into who initiated the session.
  - **Correlate Events:** Analyze network connections and firewall logs to check if there were any corresponding network connections during the time of the TeamViewer session, especially from unfamiliar or external IP addresses.
  ### Prioritization
  Alerts generated by this rule should be treated with low severity in a typical enterprise environment. This is because TeamViewer can often be legitimately used for remote support; however, every occurrence of its use should be investigated to confirm that it is not being exploited by malicious actors.
  ### Blind Spots and Assumptions
  The rule may not fire if TeamViewer is utilized in an unconventional manner, such as via a modified command line that does not match the detection criteria or if it is executed by a different process than `TeamViewer_Service.exe`. Additionally, legitimate internal use may lead to false positives. Assumptions include that the TeamViewer installation and usage remain consistent with typical enterprise practices; deviations from this could lead to missed detections.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
