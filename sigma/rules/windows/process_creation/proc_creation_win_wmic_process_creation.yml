title: New Process Created Via Wmic.EXE
id: 526be59f-a573-4eea-b5f7-f0973207634d
related:
- id: 3c89a1e8-0fba-449e-8f1b-8409d6267ec8     # For suspicious process creation
  type: derived
status: test
description: Detects new process creation using WMIC via the "process call create"
  flag
references:
- https://www.sans.org/blog/wmic-for-incident-response/
- https://github.com/redcanaryco/atomic-red-team/blob/84215139ee5127f8e3a117e063b604812bd71928/atomics/T1047/T1047.md#atomic-test-5---wmi-execute-local-process
author: Michael Haag, Florian Roth (Nextron Systems), juju4, oscd.community
date: 2019-01-16
modified: 2023-02-14
tags:
- attack.execution
- attack.t1047
- car.2016-03-002
logsource:
  category: process_creation
  product: windows
detection:
  selection_img:
  - Image|endswith: '\wmic.exe'
  - OriginalFileName: 'wmic.exe'
  selection_cli:
    CommandLine|contains|all:
    - 'process'
    - 'call'
    - 'create'
  condition: all of selection_*
falsepositives:
- Unknown
level: medium
notes: |
  ### Technical Context
  The detection rule titled "New Process Created Via Wmic.EXE" aims to identify potentially malicious activity centered around the Windows Management Instrumentation Command-line (WMIC) tool. WMIC is a powerful utility that can be exploited by threat actors to execute commands, manage local or remote systems, and manipulate other processes. This Sigma rule specifically checks for new process creation by monitoring the execution of `wmic.exe` that includes command-line parameters indicating a "process call create." 
  By analyzing the process creation logs, the rule is able to flag events where WMIC has been used to spawn new processes in a potentially unauthorized manner. The primary data sources involved in this detection are Windows Security Event Logs, particularly from Sysmon that document process creation events, detailing attributes such as the executing image's name and the command-line arguments utilized. This rule correlates to the MITRE ATT&CK Tactic of Execution (T1047 â€“ Windows Management Instrumentation) and highlights the misuse of legitimate administrative tools by adversaries to establish persistence or execute arbitrary code.
  ### Investigation Steps
  - **Review EDR Alerts:** Investigate the endpoints for alerts generated by the EDR associated with the detected event, checking for any additional context or subsequent activities that may indicate malicious intent.
  - **Analyze Sysmon Logs:** Utilize Sysmon logs to examine the command-line arguments associated with `wmic.exe` executions, particularly looking for unusual or unexpected processes being created.
  - **Query Security Logs:** Check Windows Security logs for successful login events correlating with the timing of WMIC execution to identify if the activity originated from an authorized user account or system.
  - **Inspect Network Traffic:** Use NDR tools to review any suspicious outbound connections initiated by the newly created processes to detect potential data exfiltration or command-and-control communications.
  ### Prioritization
  The medium severity level of this alert is justified due to the potential misuse of WMIC for executing unauthorized processes, which could indicate an ongoing attack or insider threat within the enterprise. Effective monitoring of such activities is crucial for early detection of more severe incidents.
  ### Blind Spots and Assumptions
  The effectiveness of this rule may be limited if:
  - WMIC is stripped from the environment or if similar functionalities are invoked through alternative scripts or tools that do not involve `wmic.exe`.
  - The rule may not fire if an adversary has administrative privileges and executes WMIC commands in a trusted context, leading to difficulty in establishing malicious intent.
  - Environmental factors such as custom process creation behaviors or legitimate administrative automations could also generate false positives that complicate response efforts. Analysts should develop a baseline of normal administrative usage for better context during investigations.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
