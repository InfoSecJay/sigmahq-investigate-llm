title: Suspicious Execution From Outlook Temporary Folder
id: a018fdc3-46a3-44e5-9afb-2cd4af1d4b39
status: test
description: Detects a suspicious program execution in Outlook temp folder
author: Florian Roth (Nextron Systems)
references:
- Internal Research
date: 2019-10-01
modified: 2022-10-09
tags:
- attack.initial-access
- attack.t1566.001
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|contains: '\Temporary Internet Files\Content.Outlook\'
  condition: selection
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The "Suspicious Execution From Outlook Temporary Folder" detection rule aims to identify potentially malicious program execution that occurs within the temporary folder used by Microsoft Outlook. The temporary folder, specifically located under `C:\Users\<username>\AppData\Local\Microsoft\Windows\Temporary Internet Files\Content.Outlook\`, is often exploited by threat actors to execute malicious payloads without raising immediate suspicion. This rule utilizes process creation logs to capture program executions and focuses on identifying the execution of unexpected or uncommon executables being launched from this location. 
  In the context of the MITRE ATT&CK framework, this rule pertains to the tactic of 'Initial Access' and the technique 'Phishing' (T1566.001), which highlights the use of social engineering tactics to instigate an attack. By monitoring for processes that originate from the Outlook temporary directory, this detection can provide critical insights into potential phishing attacks as multiple threat actors may store malware in benign-looking locations to bypass security controls.
  ### Investigation Steps
  - **Review Process Creation Logs**: Check the process creation logs for any executables originating from the specified Outlook temporary folder using the EDR solution. Look for unfamiliar or suspicious file names or hashes.
  - **Validate Executable Origin**: Cross-reference the identified executables against known malware databases or reputation services to ascertain if they are recognized threats.
  - **Conduct Network Traffic Analysis**: Utilize NDR tools to analyze network traffic generated by the suspicious processes, identifying any unusual outbound connections or communications with known malicious domains.
  - **Monitor User Activity**: Examine related user activity logs from the proxy or VPN to determine if there was any recent interaction with phishing emails or suspicious URLs that may have led to the execution of the malicious software.
  ### Prioritization
  Given the high-level categorization of this alert, the execution of a process from the Outlook temporary folder is of significant concern in an enterprise environment, as it may indicate an attempted phishing attack or initial compromise that could lead to further exploitation.
  ### Blind Spots and Assumptions
  This rule may not fire in environments where Outlook is installed but not frequently used, or if security controls do not monitor or analyze process creation events from user systems comprehensively. It assumes that malicious actors will attempt to leverage commonly trusted applications and folders, and may bypass detection through the use of legitimate executables or by executing scripts rather than standalone binaries. 
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
