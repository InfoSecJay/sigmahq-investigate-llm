title: Renamed AutoIt Execution
id: f4264e47-f522-4c38-a420-04525d5b880f
status: test
description: |
  Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe.
  AutoIt is a scripting language and automation tool for Windows systems. While primarily used for legitimate automation tasks, it can be misused in cyber attacks.
  Attackers can leverage AutoIt to create and distribute malware, including keyloggers, spyware, and botnets. A renamed AutoIt executable is particularly suspicious.
references:
- https://twitter.com/malmoeb/status/1665463817130725378?s=12&t=C0_T_re0wRP_NfKa27Xw9w
- https://www.autoitscript.com/site/
author: Florian Roth (Nextron Systems)
date: 2023-06-04
modified: 2024-11-23
tags:
- attack.defense-evasion
- attack.t1027
logsource:
  category: process_creation
  product: windows
detection:
  selection_1:
    CommandLine|contains:
    - ' /AutoIt3ExecuteScript'
    - ' /ErrorStdOut'
  selection_2:
    Hashes|contains:
    - 'IMPHASH=FDC554B3A8683918D731685855683DDF'          # AutoIt v2 - doesn't cover all binaries
    - 'IMPHASH=CD30A61B60B3D60CECDB034C8C83C290'          # AutoIt v2 - doesn't cover all binaries
    - 'IMPHASH=F8A00C72F2D667D2EDBB234D0C0AE000'          # AutoIt v3 - doesn't cover all binaries
  selection_3:
    OriginalFileName:
    - 'AutoIt3.exe'
    - 'AutoIt2.exe'
    - 'AutoIt.exe'
  filter_main_legit_name:
    Image|endswith:
    - '\AutoIt.exe'
    - '\AutoIt2.exe'
    - '\AutoIt3_x64.exe'
    - '\AutoIt3.exe'
  condition: 1 of selection_* and not 1 of filter_main_*
falsepositives:
- Unknown
level: high
notes: |
  n
  ### Technical Context
  This detection rule identifies the execution of renamed AutoIt executables, specifically AutoIt2.exe and AutoIt3.exe, which can be exploited by attackers for malicious activities. The rule checks for specific command-line parameters associated with AutoIt, as well as distinct executable hashes that are commonly linked with these tools. When a process that matches these criteria initiates while not operating under its typical names or paths, it raises an alert.
  The technical data sources involved primarily include process creation logs, where command-line arguments and image hashes are monitored to ascertain the legitimacy of the executable being run. The alerts generated from this rule are associated with the MITRE ATT&CK technique T1027 (Obfuscated Files or Information), as attackers may rename these executables to evade detection while carrying out malicious automation tasks.
  ### Investigation Steps
  - **Check Process Creation Logs**: Utilize EDR tools to review the process creation logs for any instances of the identified AutoIt executables, paying special attention to their command-line arguments and associated hashes.
  - **Validate Command-Line Arguments**: Examine the command-line parameters for suspicious activities, including unusual script execution commands or parameters that suggest malicious intent.
  - **Analyze Concerns with Renaming**: Assess the context of the file names and paths used; legitimate environments should expect AutoIt to run under its standard naming conventions and locations.
  - **Correlate with additional telemetry**: Cross-reference the alert with network connections, file system activities, and any other relevant logs to identify potential malicious behavior linked to the suspicious AutoIt executions.
  ### Prioritization
  The severity of the alerts generated by this rule is high due to the potential for automated scripts originating from renamed AutoIt executables to execute malicious payloads, leading to data breaches or system compromises.
  ### Blind Spots and Assumptions
  The rule may not trigger if unknown variants of AutoIt or custom scripts are used, especially if they do not match the specified hashes or command-line parameters. Additionally, legitimate use of AutoIt in automation tasks may lead to false positives. Engineers should note that adversaries could rename the executables to bypass detection, or run their scripts in a manner that conceals their use of AutoIt altogether.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
