title: Potential Execution of Sysinternals Tools
id: 7cccd811-7ae9-4ebe-9afd-cb5c406b824b
related:
- id: 25ffa65d-76d8-4da5-a832-3f2b0136e133
  type: derived
status: test
description: Detects command lines that contain the 'accepteula' flag which could
  be a sign of execution of one of the Sysinternals tools
references:
- https://twitter.com/Moti_B/status/1008587936735035392
author: Markus Neis
date: 2017-08-28
modified: 2024-03-13
tags:
- attack.resource-development
- attack.t1588.002
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    CommandLine|contains|windash: ' -accepteula'
  condition: selection
falsepositives:
- Legitimate use of SysInternals tools
- Programs that use the same command line flag
level: low
notes: |
  n
  ### Technical Context
  This Sigma rule is designed to detect the execution of Sysinternals tools, specifically looking for command lines that include the `-accepteula` flag. The detection mechanism utilizes process creation logs from Windows, focusing on command-line parameters associated with executed processes. By monitoring these command line arguments, the rule identifies potentially malicious or unauthorized use of Sysinternals tools, which can facilitate unauthorized activities such as privilege escalation or lateral movement within an enterprise network. The underlying MITRE ATT&CK technique associated with this rule is T1588.002 (Develop or Modify Tools), as the execution of Sysinternals tools can be considered a part of an adversary's resource development.
  ### Investigation Steps
  - **Query EDR for Process Execution:** Use the Endpoint Detection and Response (EDR) tool to examine endpoint logs for any instances of processes executed with the `-accepteula` flag to assess the context of the execution.
  - **Analyze Behavioral Logs:** Check for related behavioral indicators including network connections and file changes around the time the command was executed that could provide context to the intent behind the use of the tool.
  - **Review User Credentials:** Investigate the user accounts involved in executing the detected command by reviewing Windows Security logs to determine whether the actions were performed by legitimate users or potentially exploited accounts.
  - **Inspect Sysinternals Artifacts:** If Sysinternals tools were indeed used, look for specific artifacts or logs generated by these tools, as they can provide valuable insight into potential unauthorized or malicious activities.
  ### Prioritization
  The severity level is marked low due to the potential for legitimate use of Sysinternals tools in administrative settings; however, it warrants investigation to rule out unauthorized or malicious activity.
  ### Blind Spots and Assumptions
  This rule may not fire if an adversary uses command variations that do not include the `-accepteula` flag or employs alternate tools that do not trigger this detection. Additionally, environment configurations or custom applications may also impact the rule's effectiveness. Understanding these nuances aids analysts and engineers in recognizing potential gaps in detection coverage where an adversary could bypass this monitoring.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
