title: PsExec Service Child Process Execution as LOCAL SYSTEM
id: 7c0dcd3d-acf8-4f71-9570-f448b0034f94
related:
- id: fa91cc36-24c9-41ce-b3c8-3bbc3f2f67ba
  type: similar
status: test
description: Detects suspicious launch of the PSEXESVC service on this system and
  a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started
  a command on this system running it with highest privileges and not only the privileges
  of the login user account (e.g. the administrator account)
references:
- https://learn.microsoft.com/en-us/sysinternals/downloads/psexec
author: Florian Roth (Nextron Systems)
date: 2022-07-21
modified: 2023-02-28
tags:
- attack.execution
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    ParentImage: 'C:\Windows\PSEXESVC.exe'
    User|contains:     # covers many language settings
    - 'AUTHORI'
    - 'AUTORI'
  condition: selection
falsepositives:
- Users that debug Microsoft Intune issues using the commands mentioned in the official
  documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension
level: high
notes: |
  ### Technical Context
  The Sigma rule titled "PsExec Service Child Process Execution as LOCAL SYSTEM" is designed to detect potentially unauthorized use of the PsExec tool, a well-known utility for executing processes on remote systems. When PsExec is executed, it often runs the PSEXESVC service, which facilitates the elevated execution of commands. This rule specifically looks for instances where a child process is spawned from the PSEXESVC service, particularly under the LOCAL_SYSTEM account. The detection relies on process creation logs, scrutinizing the parent process image and user account associated with the child process. Alerts generated by this rule correlate to the MITRE ATT&CK tactic of "Execution" and specifically target the technique of "Command and Scripting Interpreter" (T1059) since PsExec allows for remote command execution by bypassing local user permissions.
  ### Investigation Steps
  - **Identify the Source Process:** Use EDR tools to trace the parent process (PSEXESVC.exe) originating the alert, determining whether it was initiated legitimately or possibly via a compromised user account.
  - **Review Process Details:** Examine the command-line parameters of the detected child process, looking for suspicious or unexpected commands that could indicate malicious activity.
  - **Check User Activity:** Investigate recent actions by the user associated with the event through Windows Security logs and any related session activity, confirming whether this user was authorized to utilize PsExec.
  - **Correlate with Other Logs:** Utilize additional telemetry from the SIEM, such as DNS queries or network connections, to identify any malicious endpoints contacted or unusual patterns of activity correlating with the execution.
  ### Prioritization
  This alert is classified as high severity due to the potential risk associated with executing privileged commands on a system, which could lead to unauthorized access, data exfiltration, or lateral movement within the network.
  ### Blind Spots and Assumptions
  One assumption is that adversaries may utilize other methods to achieve similar results without triggering this rule, such as executing commands without PsExec or using alternate tools. Additionally, the rule may not fire if the PsExec tool is executed in a context that doesn't produce the expected parent-child process relationship or if legitimate uses of PsExec are made, such as debugging with Microsoft Intune. It's crucial to keep in mind the instances of authorized remote access activities that could lead to false positives, necessitating thorough investigation to separate legitimate use from potentially malicious actions.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
