title: HackTool - QuarksPwDump Dump File
id: 847def9e-924d-4e90-b7c4-5f581395a2b4
status: test
description: Detects a dump file written by QuarksPwDump password dumper
references:
- https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm
author: Florian Roth (Nextron Systems)
date: 2018-02-10
modified: 2024-06-27
tags:
- attack.credential-access
- attack.t1003.002
logsource:
  category: file_event
  product: windows
detection:
  selection:
    TargetFilename|contains|all:
    - '\AppData\Local\Temp\SAM-'
    - '.dmp'
  condition: selection
falsepositives:
- Unknown
level: critical
notes: |
  n
  ### Technical Context
  The Sigma rule "HackTool 
  - QuarksPwDump Dump File" is designed to detect the presence of dump files generated by the QuarksPwDump password extraction tool. This rule monitors Windows file events, specifically looking for files that reside in the user's temporary directory, indicated by the pattern `\AppData\Local\Temp\SAM-`, and ending with the `.dmp` filename extension. This behavior is commonly associated with attempts to extract hashed passwords from the Security Accounts Manager (SAM) database, implicating credential theft activities. The rule is aligned with the MITRE ATT&CK framework under the tactic of Credential Access and technique T1003.002, highlighting the importance of detecting such unauthorized activities that can lead to significant security breaches.
  ### Investigation Steps
  - **Verify File Creation:** Check the file creation timestamps and related activities in the Windows Security logs to confirm the legitimacy of the creation event, paying attention to the user account under which it was created.
  - **Analyze User Context:** Use EDR tools to investigate the user session during which the dump file was created to identify any unusual behavior or additional suspicious activities that might indicate a compromised account.
  - **Review Process Activity:** Investigate the process tree leading to the creation of the suspicious dump file by examining Sysmon process creation logs for any instances where QuarksPwDump might have been executed.
  - **Inspect Network Connections:** Analyze network connections related to the user account when the dump file was created, ensuring that no unauthorized data exfiltration attempts occurred, particularly to known malicious IP addresses.
  ### Prioritization
  This alert is classified as critical because the detection of a password dumping tool like QuarksPwDump indicates a serious potential compromise of credentials, which could lead to further unauthorized access or lateral movement within the environment.
  ### Blind Spots and Assumptions
  False positives may arise if legitimate applications use similar filenames or if other benign services generate .dmp files in the specified path. Additionally, the rule may not fire if the malware generates dump files in alternate locations or uses obfuscation techniques to evade detection. Analysts should consider the possibility of the malware executing without creating a visible dump file or leveraging other tools that do not rely on the same file naming convention.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
