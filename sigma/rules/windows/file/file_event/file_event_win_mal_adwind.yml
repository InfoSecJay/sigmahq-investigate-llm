title: Adwind RAT / JRAT File Artifact
id: 0bcfabcb-7929-47f4-93d6-b33fb67d34d1
related:
- id: 1fac1481-2dbc-48b2-9096-753c49b4ec71
  type: derived
status: test
description: Detects javaw.exe in AppData folder as used by Adwind / JRAT
references:
- https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100
- https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf
author: Florian Roth (Nextron Systems), Tom Ueltschi, Jonhnathan Ribeiro, oscd.community
date: 2017-11-10
modified: 2022-12-02
tags:
- attack.execution
- attack.t1059.005
- attack.t1059.007
logsource:
  category: file_event
  product: windows
detection:
  selection:
  - TargetFilename|contains|all:
    - '\AppData\Roaming\Oracle\bin\java'
    - '.exe'
  - TargetFilename|contains|all:
    - '\Retrive'
    - '.vbs'
  condition: selection
level: high
notes: |
  n
  ### Technical Context
  The Sigma rule aims to detect the presence of malicious file artifacts associated with the Adwind RAT (Remote Access Trojan) and JRAT (Java RAT) by monitoring specific file events in the Windows operating system. The rule identifies instances where `javaw.exe` is located in the `AppData\Roaming\Oracle\bin` directory, as this is a common technique employed by attackers to obscure their malicious activities within legitimate-looking directories. Additionally, it also checks for the presence of `.vbs` files that contain the term 'Retrive,' which are often scripts used in conjunction with the RAT for command and control (C2) functions. The alert operates on data derived from file event logs, specifically looking for suspicious file paths and their extensions. This detection is relevant to the MITRE ATT&CK framework, particularly under the execution tactic (ATT&CK ID T1059), highlighting malicious use of scripting languages.
  ### Investigation Steps
  - **Query EDR for File Events:** Search EDR logs for `javaw.exe` and `.vbs` files in the specified directories to confirm the existence of malicious artifacts.
  - **Analyze Process Creation:** Investigate the process creation logs within the monitoring tools to trace the execution timeline of `javaw.exe` and any launching commands that may indicate malicious intent.
  - **Review Network Connections:** Check for any outbound network connections related to the executed `javaw.exe` process to identify potential command and control channels associated with the RAT.
  - **Cross-Reference with User Activity:** Monitor user activity and behavior in relation to the affected system to determine whether the detected file artifacts correlate with legitimate user actions or are indicative of an intrusion.
  ### Prioritization
  Alerts generated by this rule are considered high severity due to the critical risk posed by RATs, which can lead to unauthorized access, data exfiltration, and further network compromise.
  ### Blind Spots and Assumptions
  This rule may not fire if an adversary renames the malicious executable to evade detection or if the file is executed from a different, less monitored location. Additionally, variations in paths or use of alternative scripting techniques may bypass detection. There is an assumption that the necessary file event monitoring is in place and that no advanced anti-detection mechanisms are used by the attacker to mask the malicious activity.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
