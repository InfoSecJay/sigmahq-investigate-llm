title: PDF File Created By RegEdit.EXE
id: 145095eb-e273-443b-83d0-f9b519b7867b
status: experimental
description: |
  Detects the creation of a file with the ".pdf" extension by the "RegEdit.exe" process.
  This indicates that a user is trying to print/save a registry key as a PDF in order to potentially extract sensitive information and bypass defenses.
references:
- https://sensepost.com/blog/2024/dumping-lsa-secrets-a-story-about-task-decorrelation/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2024-07-08
tags:
- attack.defense-evasion
logsource:
  category: file_event
  product: windows
detection:
  selection:
    Image|endswith: '\regedit.exe'
    TargetFilename|endswith: '.pdf'
  condition: selection
falsepositives:
- Unlikely
level: high
notes: |
  n
  ### Technical Context
  This detection rule identifies the creation of PDF files by the widely known system utility `RegEdit.exe`, which is typically used for managing the Windows registry. The primary focus of this rule is to recognize instances where `RegEdit.exe` is employed to save or print registry keys as PDF files—something that could imply an attempt to exfiltrate sensitive data, circumvent security measures, or engage in other malicious activities. To activate this detection, the log sources utilized include Windows file event logs that monitor file creation activities, specifically targeting the file extension ".pdf" and the process image indicating `RegEdit.exe`. This behavior is linked to the MITRE ATT&CK framework under the tactic of **Defense Evasion**, particularly highlighting techniques related to utilizing non-standard processes for potentially malicious actions.
  ### Investigation Steps
  - **Check Process Activity:** Use EDR tools to investigate the context of `RegEdit.exe`, including its command-line arguments and associated parent processes, to determine whether it was executed legitimately or as part of a suspicious activity chain.
  - **Review File Creation Logs:** Examine file event logs to identify the exact timestamp and file path of any PDF files generated by `RegEdit.exe`, correlating this with user activity and access logs for further insights.
  - **Analyze User Context:** Investigate the user account that initiated the `RegEdit.exe` process to see if it aligns with normal operational behavior, paying special attention to any recent anomalous activities or privilege escalations.
  - **Network Correlation:** Check network logs for any subsequent communications or uploads from the device that created the PDF file to ascertain if there was an attempt to exfiltrate the PDF, potentially indicating a compromised host.
  ### Prioritization
  The alert has been classified as high severity due to the potential misuse of a trusted system tool—`RegEdit.exe`—to create potentially sensitive PDF files, which may indicate an advanced persistent threat or insider threat aiming to bypass security measures.
  ### Blind Spots and Assumptions
  This rule may not fire in scenarios where `RegEdit.exe` is executed in a way that does not involve creating PDF files, or if the PDF creation process is obfuscated through other actors or scripts that do not use the standard executable directly. Additionally, if an adversary uses alternative tools or utilities for similar purposes or if file creation is altered by system configurations or security policies, the detection may fail. Furthermore, if system logs are not properly collected or retained, this may affect the ability to capture the required artifacts necessary for alerting.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
