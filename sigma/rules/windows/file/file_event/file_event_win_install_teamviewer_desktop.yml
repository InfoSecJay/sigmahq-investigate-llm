title: Installation of TeamViewer Desktop
id: 9711de76-5d4f-4c50-a94f-21e4e8f8384d
status: test
description: TeamViewer_Desktop.exe is create during install
references:
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows
author: frack113
date: 2022-01-28
tags:
- attack.command-and-control
- attack.t1219
logsource:
  product: windows
  category: file_event
detection:
  selection:
    TargetFilename|endswith: '\TeamViewer_Desktop.exe'
  condition: selection
falsepositives:
- Unknown
level: medium
notes: |
  n
  ### Technical Context
  This Sigma rule is designed to detect the installation of TeamViewer, a remote access software, by monitoring file creation events on Windows systems. Specifically, it looks for the creation of the executable file `TeamViewer_Desktop.exe`, which is a clear indicator of the software's installation process. This rule relies on file event logs generated by Windows, capturing the file name and path of files created on the system. The rule aligns with the MITRE ATT&CK framework tactic of Command and Control (Tactic ID: TA0011) and the technique of Remote Access Software (Technique ID: T1219). By tracking the creation of such a file, incident responders can evaluate whether unauthorized or suspicious software has been installed on the enterprise systems.
  ### Investigation Steps
  - **Check Process Activity:** Use EDR tools to examine the process creation logs around the time of the event to identify any suspicious activity or associations with the `TeamViewer_Desktop.exe` file, including the processes that executed it.
  - **Review File Hashes:** Verify the hash of the `TeamViewer_Desktop.exe` file against known good and bad hashes using antivirus or endpoint protection tools to determine its legitimacy.
  - **Inspect Network Connections:** Analyze any outbound or unexpected network connections made by the `TeamViewer_Desktop.exe` process via NDR or NGFW logs to identify potential command and control communications.
  - **Examine User Accounts:** Investigate the user accounts that initiated the installation to understand access permissions and whether any unauthorized users installed the software.
  ### Prioritization
  The severity level of this alert is categorized as medium due to the potential implications of unauthorized remote access software being installed on the network, which can lead to data breaches or exploitation if misused.
  ### Blind Spots and Assumptions
  This detection rule may not fire if the installation does not produce an observable file creation event or if the executable is renamed or hidden. Furthermore, the rule assumes that file event logging is properly configured and active on monitored endpoints. Sophisticated adversaries may bypass detection by obfuscating file names, utilizing legitimate installers, or deleting traces post-installation.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
