title: WScript or CScript Dropper - File
id: 002bdb95-0cf1-46a6-9e08-d38c128a6127
related:
- id: cea72823-df4d-4567-950c-0b579eaf0846
  type: derived
status: test
description: Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe
  or wscript.exe
references:
- WScript or CScript Dropper (cea72823-df4d-4567-950c-0b579eaf0846)
author: Tim Shelton
date: 2022-01-10
modified: 2022-12-02
tags:
- attack.execution
- attack.t1059.005
- attack.t1059.007
logsource:
  category: file_event
  product: windows
detection:
  selection:
    Image|endswith:
    - '\wscript.exe'
    - '\cscript.exe'
    TargetFilename|startswith:
    - 'C:\Users\'
    - 'C:\ProgramData'
    TargetFilename|endswith:
    - '.jse'
    - '.vbe'
    - '.js'
    - '.vba'
    - '.vbs'
  condition: selection
fields:
- Image
- TargetFilename
falsepositives:
- Unknown
level: high
notes: |
  ### Technical Context
  The Sigma rule titled "WScript or CScript Dropper 
  - File" is designed to detect potentially malicious activity involving the use of WScript or CScript, which are scripting hosts for executing Windows Script files. The rule identifies instances where these executables create files with specific extensions commonly associated with script-based attacks (.jse, .vbe, .js, .vba, .vbs) in user directories or the ProgramData folder. The technical data sources involved include file event logs from the Windows operating system, particularly targeting process execution events alongside file creation events. By doing so, the rule captures suspicious behaviors that could indicate an attacker attempting to execute inline scripts or obfuscated commands designed to compromise the system, executing scripts covertly on the machine. This detection aligns with the MITRE ATT&CK tactic of **Execution** and techniques **T1059.005 (JavaScript) and T1059.007 (Visual Basic Script)**.
  ### Investigation Steps
  - **Check EDR Alerts:** Review alerts from your Endpoint Detection and Response (EDR) tool to gather additional context on the detected processes. Look for any tags or behaviors associated with WScript or CScript executions around the same timestamp to correlate activity.
    
  - **Inspect Related Files:** Investigate the created files by examining file properties (such as hash values and creation timestamps) in the directories of interest (C:\Users\ or C:\ProgramData). Validate these files against threat intelligence sources for known malicious hashes.
  - **Review Execution Context:** Analyze Windows Event Logs, especially focusing on Process Creation logs and corresponding parent-child relationships to understand how `wscript.exe` or `cscript.exe` was triggered. This can shed light on whether they were initiated by legitimate user actions or by other malicious processes.
  - **Network Activity Monitoring:** Use Network Detection and Response (NDR) tools to monitor outbound connections from the machine where the script was executed. Look for unusual network behavior or connections to known malicious domains or IP addresses that could suggest data exfiltration or command and control communications.
  ### Prioritization
  The alert generated by this rule is marked as high severity due to the potential use of scripting engines for executing malicious payloads, which can lead to data breaches, malware infections, or system compromise.
  ### Blind Spots and Assumptions
  This rule assumes that the telemetry setup correctly captures file events related to script creation and that appropriate logging levels are enabled. There are scenarios where the rule may fail to trigger, such as if scripts are executed through other means or if the files are created in locations not monitored by the rule. Additionally, attackers may utilize alternative scripting methodologies or execute scripts using different interpreters, bypassing this detection altogether. Awareness of these limitations is crucial for effective incident response and threat hunting.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and clarity, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
