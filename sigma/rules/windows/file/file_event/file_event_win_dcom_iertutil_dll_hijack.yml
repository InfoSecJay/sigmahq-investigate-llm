title: Potential DCOM InternetExplorer.Application DLL Hijack
id: 2f7979ae-f82b-45af-ac1d-2b10e93b0baa
related:
- id: e554f142-5cf3-4e55-ace9-a1b59e0def65
  type: obsolete
- id: f354eba5-623b-450f-b073-0b5b2773b6aa
  type: similar
status: test
description: Detects potential DLL hijack of "iertutil.dll" found in the DCOM InternetExplorer.Application
  Class over the network
references:
- https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html
author: Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR), wagga
date: 2020-10-12
modified: 2022-12-18
tags:
- attack.lateral-movement
- attack.t1021.002
- attack.t1021.003
logsource:
  product: windows
  category: file_event
detection:
  selection:
    Image: System
    TargetFilename|endswith: '\Internet Explorer\iertutil.dll'
  condition: selection
falsepositives:
- Unknown
level: critical
notes: |
  ### Technical Context
  The "Potential DCOM InternetExplorer.Application DLL Hijack" Sigma rule is designed to detect potentially malicious activities involving the Dynamic Component Object Model (DCOM) and the Internet Explorer application by monitoring for suspicious interactions with the `iertutil.dll` fileâ€”a critical component of the Internet Explorer browser. Specifically, the rule looks for events that indicate this DLL is being accessed unexpectedly or in a manner indicative of DLL hijacking. This type of attack often involves an adversary replacing or modifying a legitimate DLL to execute malicious code within the context of a trusted application, such as Internet Explorer. The primary technical data sources leveraged by this rule include file event logs, particularly focusing on the `TargetFilename` ending with `\Internet Explorer\iertutil.dll`. This rule aligns with the MITRE ATT&CK framework under the lateral movement tactics, specifically techniques T1021.002 (Remote Services: DCOM) and T1021.003 (Remote Services: Windows Remote Management).
  ### Investigation Steps
  - **Check EDR Alerts:** Review alerts from the Endpoint Detection and Response (EDR) tool to identify any correlated suspicious process creations or network connections to ensure there are no associated threats on the endpoint in question.
  - **Examine File Event Logs:** Investigate the Windows file event logs for access patterns involving `iertutil.dll`, specifically looking for anomalies in access times, originating processes, or unusual parent-child process relationships.
  - **Review Network Connections:** Analyze network connection logs from your Network Detection and Response (NDR) system to verify any external communications from the Internet Explorer application that could indicate exfiltration or command and control activities.
  - **Evaluate Contextual Data:** Look into the context of the event such as user behavior logs and remote management logs to ascertain whether the event originated from legitimate administrative tasks or unauthorized lateral movement attempts.
  ### Prioritization
  The alert generated by this rule is classified as critical due to the potential for significant risk associated with DLL hijacking, which may enable attackers to execute arbitrary code with the same privileges as the affected application, potentially leading to system compromise.
  ### Blind Spots and Assumptions
  This detection rule may not fire in scenarios where the DLL hijacking is performed by a legitimate administrative process, making it difficult to differentiate malicious activity from regular administrative operations. Additionally, if user permissions are modified to bypass certain logging mechanisms, the rule may fail to trigger. It is also assumed that event logging is properly configured to capture file events, and any misconfigurations could result in undetected malicious behavior. Further, attacks utilizing less common DLLs or other browser components may evade this detection strategy.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
