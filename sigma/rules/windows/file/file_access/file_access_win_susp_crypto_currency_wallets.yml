title: Access To Crypto Currency Wallets By Uncommon Applications
id: f41b0311-44f9-44f0-816d-dd45e39d4bc8
status: experimental
description: |
  Detects file access requests to crypto currency files by uncommon processes.
  Could indicate potential attempt of crypto currency wallet stealing.
references:
- Internal Research
author: X__Junior (Nextron Systems)
date: 2024-07-29
tags:
- attack.t1003
- attack.credential-access
logsource:
  category: file_access
  product: windows
  definition: 'Requirements: Microsoft-Windows-Kernel-File ETW provider'
detection:
  selection:
  - FileName|contains:
    - '\AppData\Roaming\Ethereum\keystore\'
    - '\AppData\Roaming\EthereumClassic\keystore\'
    - '\AppData\Roaming\monero\wallets\'
  - FileName|endswith:
    - '\AppData\Roaming\Bitcoin\wallet.dat'
    - '\AppData\Roaming\BitcoinABC\wallet.dat'
    - '\AppData\Roaming\BitcoinSV\wallet.dat'
    - '\AppData\Roaming\DashCore\wallet.dat'
    - '\AppData\Roaming\DogeCoin\wallet.dat'
    - '\AppData\Roaming\Litecoin\wallet.dat'
    - '\AppData\Roaming\Ripple\wallet.dat'
    - '\AppData\Roaming\Zcash\wallet.dat'
  filter_main_system:
    Image: System
  filter_main_generic:
        # This filter is added to avoid large amount of FP with 3rd party software. You should remove this in favour of specific filter per-application
    Image|startswith:
    - 'C:\Program Files (x86)\'
    - 'C:\Program Files\'
    - 'C:\Windows\system32\'
    - 'C:\Windows\SysWOW64\'
  filter_optional_defender:
    Image|startswith: 'C:\ProgramData\Microsoft\Windows Defender\'
    Image|endswith:
    - '\MpCopyAccelerator.exe'
    - '\MsMpEng.exe'
  condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
falsepositives:
- Antivirus, Anti-Spyware, Anti-Malware Software
- Backup software
- Legitimate software installed on partitions other than "C:\"
- Searching software such as "everything.exe"
level: medium
notes: |
  ### Technical Context
  This Sigma rule is designed to detect unauthorized access attempts to cryptocurrency wallet files by uncommon applications. The detection logic focuses on file access requests targeting specific file paths that store keys for various cryptocurrencies, such as Bitcoin, Ethereum, Monero, and others. By monitoring Windows file access events, particularly those involving files located in the AppData directory associated with cryptocurrency wallets, the rule identifies unusual behavior consistent with potential wallet theft. The primary data sources leveraged in this rule include Windows file access logs, which can capture "file access" events when processes attempt to read or write files. This detection aligns with the MITRE ATT&CK tactics and techniques for credential access, specifically T1003, which pertains to credential dumping.
  ### Investigation Steps
  - **Verify the Alert Source:** Use EDR solutions to review the specific files accessed, the processes involved, and the timestamps associated with these events. Check if the processes initiating access are recognized and legitimate within your environment.
    
  - **Analyze Process Behavior:** Look for signs of suspicious activity in the detected processes using system logs and EDR telemetry, particularly focusing on their command-line parameters and parent-child process relationships.
    
  - **Check for Authorized Software:** Review your organizational policies and inventory to determine if the detected processes are part of authorized applications that may legitimately access cryptocurrency wallet files.
    
  - **Conduct a Threat Hunt:** Utilize logs from AV and endpoint security solutions to search for additional indicators of compromise. Correlate the findings with network traffic to see if there are any anomalies in the context of these processes accessing specific wallet files.
  ### Prioritization
  Given the sensitive nature of cryptocurrency wallets and the potential financial impact of theft, alerts generated by this rule should be treated with medium severity. Immediate investigation is warranted due to the possibility that unauthorized processes may indicate a malicious intent to compromise user assets.
  ### Blind Spots and Assumptions
  This rule may not fire if legitimate, but uncommon applications access the specified cryptocurrency wallet files, leading to false negatives. Additionally, the presence of security tools in environments may inhibit detection due to filtering implemented in anticipation of legitimate activity. The rule may also not trigger if the targeted files are accessed outside the monitored paths or through alternative methods not captured by the established telemetry, such as direct disk access or encryption methods that obfuscate file paths.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and its relevance to specific environments, we recommend validating the content and adapting it to suit specific operational needs. Please communicate any changes to the detection engineering team.
