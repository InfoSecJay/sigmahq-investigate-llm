title: SyncAppvPublishingServer Bypass Powershell Restriction - PS Module
id: fe5ce7eb-dad8-467c-84a9-31ec23bd644a
related:
- id: fde7929d-8beb-4a4c-b922-be9974671667
  type: derived
- id: 9f7aa113-9da6-4a8d-907c-5f1a4b908299
  type: derived
status: test
description: Detects SyncAppvPublishingServer process execution which usually utilized
  by adversaries to bypass PowerShell execution restrictions.
references:
- https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/
author: 'Ensar Åžamil, @sblmsrsn, OSCD Community'
date: 2020-10-05
modified: 2022-12-02
tags:
- attack.defense-evasion
- attack.t1218
logsource:
  product: windows
  category: ps_module
  definition: 0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
detection:
  selection:
    ContextInfo|contains: 'SyncAppvPublishingServer.exe'
  condition: selection
falsepositives:
- App-V clients
level: medium
notes: |
  ### Technical Context
  This detection rule identifies the execution of the `SyncAppvPublishingServer.exe` process, which is commonly exploited by malicious actors to circumvent PowerShell execution restrictions in a Windows environment. The rule leverages PowerShell module logging to analyze content generated by `SyncAppvPublishingServer.exe`. When executed, this application can trigger a series of events indicative of potential exploitation attempts. The data sources relevant to this detection include Windows Security and PowerShell logs, specifically focusing on command line parameters and execution context associated with the application. The associated MITRE ATT&CK tactic for this rule aligns with Defense Evasion under the technique T1218, which represents methods adversaries may employ to evade security controls.
  ### Investigation Steps
  - **Review PowerShell Logs:** Examine PowerShell module logs for any instances of `SyncAppvPublishingServer.exe` execution alongside suspicious command-line arguments or unusual activity leading up to the alert.
  - **Analyze Process Environment:** Use your EDR tool to analyze the parent process, and any associated child processes created by `SyncAppvPublishingServer.exe`, looking for unexpected behavior or lateral movement attempts.
  - **Inspect Network Connections:** Investigate any outbound network connections initiated by this process to identify potential command and control (C2) communications or data exfiltration attempts.
  - **Correlate with Other Alerts:** Cross-reference the alert with other logs from AV, NGFW, or NDR for corroborative evidence of malicious behavior or patterns that align with known indicators of compromise.
  ### Prioritization
  The alert is prioritized as medium severity because the execution of `SyncAppvPublishingServer.exe` can indicate attempts to bypass security controls, potentially leading to further malicious actions if not investigated promptly.
  ### Blind Spots and Assumptions
  This rule may not fire in scenarios where security monitoring is minimal or improperly configured, such as environments with disabled PowerShell logging or where the use of Application Virtualization (App-V) is legitimate and frequent. Additionally, if adversaries utilize application whitelisting strategies or rename the executable, the detection may be circumvented. Analysts should be cautious not to misinterpret legitimate App-V client usage as malicious activity without thorough investigation.
  > **Disclaimer:** This investigation guide was created using generative AI technology and has not been reviewed for its accuracy and relevance. While every effort has been made to ensure its quality and relevance, we recommend validating the content and adapting it to suit specific environment and operational needs. Please communicate any changes to the detection engineering team.
